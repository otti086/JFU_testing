on_actions = {
	on_startup = {
		effect = {
			if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = GER}}
				set_variable={host = GER.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = ITA}}
				set_variable={host = ITA.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = ROM}}
				set_variable={host = ROM.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = HUN}}
				set_variable={host = HUN.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = BUL}}
				set_variable={host = BUL.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = FIN}}
				set_variable={host = FIN.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = ENG}}
				set_variable={host = ENG.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = USA}}
				set_variable={host = USA.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = CAN}}
				set_variable={host = CAN.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = SAF}}
				set_variable={host = SAF.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = RAJ}}
				set_variable={host = RAJ.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = AST}}
				set_variable={host = AST.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = NZL}}
				set_variable={host = NZL.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = JAP}}
				set_variable={host = JAP.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = MAN}}
				set_variable={host = MAN.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = SOV}}
				set_variable={host = SOV.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = FRA}}
				set_variable={host = FRA.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = BRA}}
				set_variable={host = BRA.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = MEX}}
				set_variable={host = MEX.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = IRE}}
				set_variable={host = IRE.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = SPR}}
				set_variable={host = SPR.id}
			}
			else_if = {
				limit = {has_game_rule = {rule = hosttool_game_rule option = OFF}}
				set_global_flag = HMM_no_hosttool
			}
			if = { # i hate errors
				limit = {
					NOT = { has_global_flag = HMM_no_hosttool }
				}
				var:host = {
					set_variable = { marked_states = 0 }
					set_variable = { prod_effi = 30 }
					set_variable = { prod_type = 0 }
					set_country_flag = host
				}
			}
			SWE = { JFU_startup_on_action = yes }
		}		
	}
	on_daily = {
		effect = {
			HFU_fuel_on_daily_scripted_effect = yes			
		}
	}
	on_monthly = {
		effect = {
			every_country = {
				limit = {
					OR = {
						axis = yes
						allies = yes
					}
					NOT = {
						OR = {
							has_war = yes
							has_idea = peace_training
						}
					}
				}
				add_ideas = peace_training
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = JFU_pre_sets 
							option = JFU_ALTERNATIVE_GS
						}
					}
				}
				if = { 
					limit = {
						original_tag = HOL
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = HOL
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = JFU_pre_sets 
							option = JFU_ALTERNATIVE_GS
						}
					}
				}
				if = { 
					limit = {
						original_tag = BEL
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = BEL
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = JFU_pre_sets 
							option = JFU_ALTERNATIVE_GS
						}
					}
				}
				if = { 
					limit = {
						original_tag = NOR
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = NOR
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = JFU_pre_sets 
							option = JFU_ALTERNATIVE_GS
						}
					}
				}
				if = { 
					limit = {
						original_tag = DEN
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = DEN
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					has_global_flag = YUGO_FREE_COLAB_FLAG
				}
				if = { 
					limit = {
						original_tag = YUG
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = YUG
								is_controlled_by = ITA
							}
						}
					
						add_compliance = 75 
					}
				}
			}
			if = {
				limit = {
					original_tag = YUG
					NOT = {
						GER ={ has_completed_focus = GER_anschluss }
					}
				}
				add_threat = 50
			}
			if = {
				limit = { 
				original_tag = POL
				}
				SOV = {transfer_state = 96 }
				SOV = {transfer_state = 95 }
				SOV = {transfer_state = 94 }
				SOV = {transfer_state = 784 }
				SOV = {transfer_state = 93 }
				SOV = {transfer_state = 91 }
				SOV = {transfer_state = 89 }
				SOV = {transfer_state = 97 }
				every_state = {
					limit = {
						AND = {
							is_core_of = POL
							is_controlled_by = GER
						}
					}
				
					set_compliance = 80 
				}
				add_equipment_to_stockpile = { type = infantry_equipment_1 amount = 100000 }
			}
			if = {
				limit = {
					original_tag = GRE
					ITA = { has_war_with = GRE }
				}
				add_threat = 4
				ITA = {
					transfer_state = 185
					transfer_state = 731
					transfer_state = 47
					transfer_state = 184
					transfer_state = 186
					transfer_state = 182
					transfer_state = 187
					every_state = {
             		   limit = {
              		     	is_core_of = GRE
             		      	is_controlled_by = ITA
              		 	}
              		  add_compliance = 50
		   			}
				}
			
			}
			if = {
				limit = {
					original_tag = CHI
					JAP = { has_war_with = CHI }
				}
				if = { 
					limit = {
						JAP = {
							has_country_flag = MAN_GETS_CHINA
						}
					}
					MAN = {
						annex_country = { target = CHI }
					}
					add_threat = 40
				}
				else = {
					JAP = {
						annex_country = { target = CHI }
					}
					add_threat = 40
				}			
			}
			if = {
				limit = {
					original_tag = FIN 
					SOV = { has_war_with = FIN}
					NOT = {
						GER = { has_war_with = SOV }
					}
				}
				white_peace = SOV
				SOV = {
					transfer_state = 147
					transfer_state = 146
				}
			}
			if = {
				limit = {
					original_tag = YUG
					ITA = { has_war_with = YUG }
				}
				add_threat = 4
				HUN = {
					transfer_state = 45
					transfer_state = 764
				}
				ITA = {
					transfer_state = 102
					transfer_state = 103
					transfer_state = 104
					transfer_state = 105
					transfer_state = 106
					transfer_state = 107
					transfer_state = 108
					transfer_state = 109
					transfer_state = 804
					transfer_state = 802
					transfer_state = 803
					transfer_state = 102
					transfer_state = 853
				}
			}
			if = {
				limit = {
					original_tag = ETH
					ITA = {has_war_with = ETH}
				}
				ITA = { annex_country = { target =  ETH	} }
			}
			if = {
				limit = {
					original_tag = SPR
				}
				set_global_flag = scw_over
				every_state = {
					limit = { 
						is_core_of = SPA
					}
					transfer_state_to = SPR 
				}
				SPR = {
					add_timed_idea = { idea = SPR_carlists_uprising days = 365 }
					add_ideas = { idea = SPA_recovering_from_civil_war}
					if = { limit = { country_exists = SPD } annex_country = { target = SPD} }
				}
				ENG = { add_war_support = 0.1}
				CAN = { add_war_support = 0.1}
				if = { limit = { country_exists = SAF } SAF = { add_war_support = 0.1} }
				if = { limit = { country_exists = NZL } NZL = { add_war_support = 0.1} }
				RAJ = { add_war_support = 0.1}
				SOV = { add_war_support = 0.1}

			}
			if = {
				limit = {
					original_tag = SPA 
				}

				every_state = {
					limit = { 
						is_core_of = SPA
					}
					transfer_state_to = SPR 
				}
				set_global_flag = scw_over
				set_global_flag = nationalist_victory
				SPR = { country_event = { id = lar_news.1 hours = 6 } }
			}
			if = {
				limit = {
					original_tag = SPD
				}
				every_state = {
					limit = { 
						AND = {
							is_core_of = SPR
							NOT = {
								is_controlled_by = SPA
							}
						}
					}
					transfer_state_to = SPR 
				}
				every_state = {
					limit = {
						AND = {
							is_core_of = SPR
							NOT = {
								is_controlled_by = SPR
							}
						}
					}
					transfer_state_to = SPA
				}
				if = {
					limit = {
						has_global_flag = scw_early_end
					}
					clr_global_flag = scw_early_end
					set_global_flag = scw_over
					set_global_flag = nationalist_victory
					SPR = { country_event = { id = lar_news.1 hours = 6 } }
				}
				if = { 
					limit = { 
						has_war = yes
					} 
					set_global_flag = scw_early_end
				}				
			}
			if = {
				limit = {
					original_tag = JAP 
				}
				USA = {
					annex_country = { target = JAP }
					if = {
						limit = {
							country_exists = MAN 
						}
						annex_country = { target = MAN}
					}
					if = {
						limit = {
							country_exists = SIA 
						}
						annex_country = { target = SIA}
					}
				}
			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM = { tag = FRA }
					FROM.FROM = { is_core_of = FRA }
					OR ={  AND ={  FRA = { surrender_progress	> 0.32 NOT = { OR = { controls_state = 18 controls_state = 785 controls_state = 16 }} } }	FRA = { surrender_progress	> 0.5	}	 }
					NOT = { FRA = { has_country_flag = france_is_kill }}
				}

				tp_divs_out_of_france = yes 
 
				FRA = { 
					set_country_flag = france_is_kill  
					 set_capital = { state = 539 }
					country_event = { id = france.10 }
					set_global_flag = fall_of_france
					set_cosmetic_tag = FRA_FREE
					news_event = { id = news.34 days = 0 }
				

					if = { limit = { date > 1939.9.20 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.10.10 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.10.30 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.11.20 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.12.10 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.12.30 } add_to_variable = { var = FRA_legitimacy value = 5 } }

					set_temp_variable = { AXIScasualtiesk = 0 }
					add_to_temp_variable = { AXIScasualtiesk = ROM.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = ITA.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = HUN.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = GER.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = SPR.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = BUL.casualties_k }	
					divide_temp_variable  = { AXIScasualtiesk  = 3  }
					add_to_variable = { var = FRA_legitimacy value = AXIScasualtiesk }
					divide_variable = { DAYSFRANCEHELD = 4 }
					add_to_variable = { var = FRA_legitimacy value = DAYSFRANCEHELD }
				}

				JFU_vichy_france = yes
				
				ENG = { 
					retire_country_leader = yes					
					create_country_leader = {
						name = "Winston Churchill"
						desc = "POLITICS_WINSTON_CHURCHILL_DESC"
						picture = "Portrait_Britain_Winston_Churchill.dds"
						expire = "1965.1.1"
						ideology = conservatism
						traits = {	british_bulldog	}
					}

					add_stability = 0.1
					add_war_support = 0.1
				}
				GER = {  country_event = { id = france.14 }}
				if = {
					limit = { 
						AND = { 
							country_exists = JAP 
							SIA = { is_ai = yes} 
						}
					}
					JAP = {
						transfer_state = 670 
						transfer_state = 286 
						transfer_state = 741 
						transfer_state = 671 
						transfer_state = 728 
					}
				}
				if = { 
					limit = { 
						AND = { 
							country_exists = JAP 
							SIA = {is_ai = no }
						}
					}
					SIA = {
						transfer_state = 741
						transfer_state = 670
					}
					JAP = {
						transfer_state = 286
						transfer_state = 671
						transfer_state = 728
					}
					741 = { add_core_of = SIA }
					670 = { add_core_of = SIA}
				}
			}
			if = {
				limit = {
					AND = {
						195 = { is_controlled_by = FIN }
						NOT = {
							GER = { has_war_with = SOV }
						}
					}
				}
				SOV = { 
					white_peace = {
						tag = FIN 
						message = FIN_agree_peace 
					} 
				}
			}
			if = {
				limit = {
					OR = {
						335 = { is_controlled_by = GER }
						672 = { is_controlled_by = GER }
						334 = { is_controlled_by = GER }
					}
				}
				HOL = {
					transfer_state = 335
					transfer_state = 672
					transfer_state = 334
				}
			}
		}
	}
	on_paradrop = {
	    effect = {
			if = {  limit = { OR = { is_core_of = SPR state = 118 } } ROOT = { PREV = {  teleport_armies = { to_state = FROM } } }	}
		}
	}
	on_naval_invasion = { effect ={  if = { limit = { spanish_coastline = yes } teleport_armies = {limit = { allies = yes  } to_state = FROM }  PREV = { if = { limit = { SPR = { owns_state = 41 } }transfer_state_to = SPR}  else = { transfer_state_to = GER }  }  } }   }	
	on_weekly_JAP = {
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_pre_sets
						option = JFU_ALTERNATIVE_GS
					}
					date > 1941.1.1
				}
				JAP = { island_hopping_JAP = yes }
			}
		}
	}
	on_weekly_USA = {
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_pre_sets
						option = JFU_ALTERNATIVE_GS
					}
					date > 1941.1.1
				}
				USA = { island_hopping_USA = yes }
			}
		}
	}
	on_monthly_SOV = {
		effect = {
			if = { limit = { AND = { date > 1937.8.20
									 NOT = { has_global_flag = SOV_SPR_gold_true } } }
				add_timed_idea = { idea = SPR_seized_spanish_gold_reserves days = 365 }
				set_global_flag = SOV_SPR_gold_true
			}
		}
	}
	on_weekly_SOV = {
		effect = {
			if = {
				limit = {
					has_dynamic_modifier = { modifier = SOV_BARB_Debuff }
				}
			SOV_Barb_debuff_effect = yes
			}
		}
	}
	on_daily_FRA = {
		effect = {
			if = {
				limit = {
					AND = {
						GER = { has_completed_focus = GER_danzig_or_war }
						NOT = { FRA = { has_country_flag = france_is_kill} }
					}
				}
			}
			add_to_variable = { var = DAYSFRANCEHELD value = 1 }
		}
	}
}