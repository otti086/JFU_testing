###########################
# NSB Soviet Events
###########################

add_namespace = NSB_soviet_paranoia_system_events
add_namespace = NSB_soviet_propaganda_capmaign_events
add_namespace = NSB_soviet_foreign_politics_events
add_namespace = NSB_soviet_academy_of_sciences
add_namespace = NSB_soviet_atomic_bomb_project
add_namespace = NSB_soviet_five_year_plan
add_namespace = NSB_soviet_great_patriotic_war
add_namespace = NSB_soviet_soviet_german_trade_agreement
add_namespace = NSB_soviet_policies_of_collective_security
add_namespace = NSB_soviet_comecon
add_namespace = NSB_soviet_spanish_civil_war
add_namespace = NSB_soviet_planned_economy
add_namespace = NSB_Soviet_fascist_civil_war
add_namespace = NSB_soviet_communist_civil_war
add_namespace = NSB_soviet_permanent_revolution
add_namespace = NSB_soviet_for_the_common_good
add_namespace = NSB_soviet_civil_war_common
add_namespace = NSB_soviet_fascist_tsarist
add_namespace = NSB_soviet_nationalist


#########################
### INTRO TO PARANOIA ###
#########################

### PARANOIA SYSTEM STARTS ###
country_event = {
	id = NSB_soviet_paranoia_system_events.01
	title = NSB_soviet_paranoia_system_events.01.t
	desc = NSB_soviet_paranoia_system_events.01.desc
	picture = GFX_report_event_stalin_01
	
	is_triggered_only = yes

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			SOV_initiate_paranoia_effect = yes
		}
	}

	trigger = {
		NOT = { has_completed_focus = SOV_the_bloc_of_rights_and_trotskyites }
	}

	option = { #GOOD TO KNOW, THANKS
		name = NSB_soviet_paranoia_system_events.01.a
		
		custom_effect_tooltip = SOV_paranoia_system_intro_tt
		unlock_decision_category_tooltip = SOV_paranoia_system

		#Stalin gets paranoid
		effect_tooltip = {
			add_country_leader_trait = stalin_political_paranoia
		}

		#NKVD chiefs will make Political Paranoia worse
		custom_effect_tooltip = SOV_paranoia_system_nkvd_trait_tt
	}
}

####################
### ADMIN PURGES ###
####################

### ADVISOR ACCUSED OF TREASON - ADMIN ###
country_event = {
	id = NSB_soviet_paranoia_system_events.11
	title = NSB_soviet_paranoia_system_events.11.t
	desc = NSB_soviet_paranoia_system_events.11.desc
	picture = GFX_report_event_soviet_purge_trial
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE MODE ON
		name = NSB_soviet_paranoia_system_events.11.a
		ai_chance = {
			base = 10
		}
		hidden_effect = {
			every_character = {
				limit = {
					is_character_slot = political_advisor
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes
			}
		}

		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_high_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}

		clear_variable = SOV_purged_character_for_loc
	}

	option = { #PURGE MODE OFF
		name = NSB_soviet_paranoia_system_events.11.b
		ai_chance = {
			base = 1
			#modifier = { #Don't purge historically-not-purged people on historical # SOV_historically_not_purged_flag not implemented for now -> Adds more randomness
			#	factor = 100
			#	SOV_is_going_historical_stalinist = yes
			#	any_character = {
			#		has_character_flag = SOV_targeted_for_purge_flag
			#		has_character_flag = SOV_historically_not_purged_flag
			#	}
			#}
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
		clear_variable = SOV_purged_character_for_loc
	}
}

### CIVIL SERVANTS PURGED - ADMIN ###
country_event = {
	id = NSB_soviet_paranoia_system_events.12
	title = NSB_soviet_paranoia_system_events.12.t
	desc = NSB_soviet_paranoia_system_events.12.desc
	picture = GFX_report_event_SOV_purge_administration
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.12.a
		ai_chance = {
			base = 10
		}

		add_timed_idea = {
			idea = SOV_understaffed_bureaucracy
			days = 365
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_medium_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.12.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}

		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes
	}
}

### NKVD PURGED - ADMIN ###
country_event = {
	id = NSB_soviet_paranoia_system_events.13
	title = NSB_soviet_paranoia_system_events.13.t
	desc = NSB_soviet_paranoia_system_events.13.desc
	picture = GFX_report_event_soviet_purge_trial

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.13.a
		ai_chance = {
			base = 10
		}

		if = {
			limit = {
				has_idea = SOV_genrikh_yagoda
			}
			hidden_effect = {
				SOV_genrikh_yagoda = {
					SOV_purge_character_effect = yes
				}
			}

			custom_effect_tooltip = SOV_characters_will_be_purged_tt
			character_list_tooltip = {
				limit = {
					is_character = SOV_genrikh_yagoda
				}
			}

			activate_advisor = SOV_nikolay_yezhov
		}
		else_if = {
			limit = {
				has_idea = SOV_nikolay_yezhov
			}
			hidden_effect = {
				SOV_nikolay_yezhov = {
					SOV_purge_character_effect = yes
				}
			}
			custom_effect_tooltip = SOV_characters_will_be_purged_tt
			character_list_tooltip = {
				limit = {
					is_character = SOV_nikolay_yezhov
				}
			}

			activate_advisor = SOV_lavrenty_beriya
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_high_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.13.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes
	}
}

### GREAT PURGE - MOSCOW TRIALS - ADMIN ###
country_event = {
	id = NSB_soviet_paranoia_system_events.19
	title = NSB_soviet_paranoia_system_events.19.t
	desc = {
		text = NSB_soviet_paranoia_system_events.19.desc_1 #first Moscow trial 
		trigger = {
			has_country_flag = SOV_purge_event_unavoidable_flag
			check_variable = { SOV_moscow_trial_index < 2 }
		}
	}
	desc = {
		text = NSB_soviet_paranoia_system_events.19.desc_2 #second Moscow trial 
		trigger = {
			has_country_flag = SOV_purge_event_unavoidable_flag
			check_variable = { SOV_moscow_trial_index > 1 } 
			check_variable = { SOV_moscow_trial_index < 3 } 
		}
	}
	desc = {
		text = NSB_soviet_paranoia_system_events.19.desc_3 #last Moscow trial 
		trigger = {
			has_country_flag = SOV_purge_event_unavoidable_flag
			check_variable = { SOV_moscow_trial_index > 2 }
		}
	}
	desc = {
		text = NSB_soviet_paranoia_system_events.19.desc_4 #Generic Purge
		trigger = { NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } }
	}

	picture = GFX_report_event_SOV_purge_administration
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = { #PURGE MODE ON
		name = NSB_soviet_paranoia_system_events.19.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			every_character = {
				limit = {
					is_character_slot = political_advisor
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes
				
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#PARANOIA decreases
		SOV_paranoia_very_high_decrease_effect = yes

		#Increase moscow trial index by 1 for next event title
		add_to_variable = { SOV_moscow_trial_index = 1 }

		if = {
			limit = {
				has_country_flag = SOV_purge_event_unavoidable_flag
			}
			custom_effect_tooltip = SOV_purge_event_unavoidable_purge_great_tt
		}
		else_if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}

		#Clear flags forbidding the "avoid purge" option from showing up
		SOV_clear_unavoidable_purge_flags_effect = yes
	}

	option = { #PURGE MODE OFF
		name = NSB_soviet_paranoia_system_events.19.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
			NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } #Used for historical purges triggered via focus
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA increases
		SOV_paranoia_very_high_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes

		#Increase moscow trial index by 1 for next event title
		add_to_variable = { SOV_moscow_trial_index = 1 }
	}
}

###################
### ARMY PURGES ###
###################

### GENERAL ACCUSED OF TREASON - ARMY ###
unit_leader_event = {
	id = NSB_soviet_paranoia_system_events.21
	title = NSB_soviet_paranoia_system_events.21.t
	desc = NSB_soviet_paranoia_system_events.21.desc
	picture = GFX_report_event_soviet_purge_officers_02
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.21.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			random_army_leader = {
				limit = {
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes
			}
		}
		#custom_effect_tooltip = SOV_retire_purged_character_tt

		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#RANDOM GENERALS COWED
		SOV_paranoia_daunt_generals_minor_effect = yes

		#PARANOIA DECREASES based on general's level
		set_variable = { SOV_unit_leader_level = SOV_accused_unit_leader_level } #Set the appropriate var used in the scripted effect
		SOV_paranoia_decrease_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_accused_decrease_tt

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
		clear_variable = SOV_purged_character_for_loc
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.21.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		SOV_paranoia_increase_based_on_unit_leader_level_effect = yes

		#PARANOIA INCREASES
		set_variable = { SOV_unit_leader_level = SOV_accused_unit_leader_level } #Set the appropriate var used in the scripted effect
		SOV_paranoia_increase_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_accused_increase_tt

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
		clear_variable = SOV_purged_character_for_loc
	}
}

### CONSPIRACY IN THE ACADEMY - ARMY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.22
	title = NSB_soviet_paranoia_system_events.22.t
	desc = NSB_soviet_paranoia_system_events.22.desc
	picture = GFX_report_event_SOV_purge_administration
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.22.a
		ai_chance = {
			base = 10
		}

		add_ideas = SOV_anti_soviet_military_thinking_banned_army

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_low_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.22.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes
	}
}

### ANTI-SABOTEUR CAMPAIGN - ARMY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.23
	title = NSB_soviet_paranoia_system_events.23.t
	desc = NSB_soviet_paranoia_system_events.23.desc
	picture = GFX_report_event_soviet_soldiers_tank
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.23.a
		ai_chance = {
			base = 10
		}

		add_timed_idea = {
			idea = SOV_training_activities_curtailed
			days = 365
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_low_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		} 
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.23.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes
	}
}

### GENERAL ACCUSES GENERAL - ARMY ###
unit_leader_event = {
	id = NSB_soviet_paranoia_system_events.24
	title = NSB_soviet_paranoia_system_events.24.t
	desc = NSB_soviet_paranoia_system_events.24.desc
	picture = GFX_report_event_soviet_purge_officers_02
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE ACCUSED
		name = NSB_soviet_paranoia_system_events.24.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			random_army_leader = {
				limit = {
					has_character_flag = SOV_purge_accused_flag
				}
				SOV_purge_character_effect = yes
			}
		}
		#custom_effect_tooltip = SOV_retire_accused_character_tt
		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_purge_accused_flag
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#RANDOM GENERALS COWED
		SOV_paranoia_daunt_generals_minor_effect = yes
		
		#PARANOIA decreases based on general's level
		set_variable = { SOV_unit_leader_level = SOV_accused_unit_leader_level } #Set the appropriate var used in the scripted effect
		SOV_paranoia_decrease_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_accused_decrease_tt

		#CLEAN EVERYTHING THANKS
		hidden_effect = {
			clear_variable = SOV_accused_unit_leader_level
			clear_variable = SOV_accuser_unit_leader_level
			clear_variable = SOV_accused_character_for_loc
			clear_variable = SOV_accuser_character_for_loc
			every_army_leader = {
				limit = {
					has_character_flag = SOV_purge_accuser_flag
				}
				clr_character_flag = SOV_purge_accuser_flag
			}
		}

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
	}

	option = { #PURGE ACCUSER 
		name = NSB_soviet_paranoia_system_events.24.b
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				SOV_is_going_historical_stalinist = no
			}
		}

		hidden_effect = {
			random_army_leader = {
				limit = {
					has_character_flag = SOV_purge_accuser_flag
				}
				SOV_purge_character_effect = yes
			}
		}
		#custom_effect_tooltip = SOV_retire_accuser_character_tt
		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_purge_accuser_flag
			}
		}

		#RANDOM GENERALS COWED
		SOV_paranoia_daunt_generals_minor_effect = yes

		#PARANOIA decreases based on general's level
		set_variable = { SOV_unit_leader_level = SOV_accuser_unit_leader_level } #Set the appropriate var used in the scripted effect and clean vars and flags
		SOV_paranoia_decrease_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_accused_decrease_tt

		#CLEAN EVERYTHING THANKS
		hidden_effect = {
			clear_variable = SOV_accused_unit_leader_level
			clear_variable = SOV_accuser_unit_leader_level
			clear_variable = SOV_accused_character_for_loc
			clear_variable = SOV_accuser_character_for_loc
			every_army_leader = {
				limit = {
					has_character_flag = SOV_purge_accused_flag
				}
				clr_character_flag = SOV_purge_accused_flag
			}
		}

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.24.c
		ai_chance = {
			base = 2
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		every_army_leader = { #Both characters get cowed
			limit = {
				OR = {
					has_character_flag = SOV_purge_accuser_flag
					has_character_flag = SOV_purge_accused_flag
				}
			}
			add_unit_leader_trait = trait_SOV_cowed_by_stalin_army
		}

		#PARANOIA INCREASES
		set_variable = { SOV_unit_leader_level = SOV_accused_unit_leader_level } #Set the appropriate var used in the scripted effect and clean vars and flags
		add_to_variable = { SOV_unit_leader_level = SOV_accuser_unit_leader_level }
		SOV_paranoia_increase_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_both_increase_tt

		#CLEAN EVERYTHING THANKS
		hidden_effect = {
			clear_variable = SOV_accused_unit_leader_level
			clear_variable = SOV_accuser_unit_leader_level
			clear_variable = SOV_accused_character_for_loc
			clear_variable = SOV_accuser_character_for_loc
			random_army_leader = {
				limit = {
					has_character_flag = SOV_purge_accused_flag
				}
				clr_character_flag = SOV_purge_accused_flag
			}
			random_army_leader = {
				limit = {
					has_character_flag = SOV_purge_accuser_flag
				}
				clr_character_flag = SOV_purge_accuser_flag
			}
		}
	}
}

### GREAT PURGE OF JUNIOR ARMY OFFICERS - ARMY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.28
	title = NSB_soviet_paranoia_system_events.28.t
	desc = NSB_soviet_paranoia_system_events.28.desc
	picture = GFX_report_event_SOV_purge_young_officers
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = { #PURGE THEM!!
		name = NSB_soviet_paranoia_system_events.28.a
		ai_chance = {
			base = 10
		}

		if = {
			limit = {
				has_idea = SOV_purged_junior_army_officers_3
			}
			#NOTHING HAPPENS, but this should not be a possibility
			log = "I CAN'T MAKE THIS WORSE FOR GODS SAKE!"
		}
		else_if = {
			limit = {
				has_idea = SOV_purged_junior_army_officers_2
			}
			swap_ideas = {
				remove_idea = SOV_purged_junior_army_officers_2
				add_idea = SOV_purged_junior_army_officers_3
			}
		}
		else_if = {
			limit = {
				has_idea = SOV_purged_junior_army_officers_1
			}
			swap_ideas = {
				remove_idea = SOV_purged_junior_army_officers_1
				add_idea = SOV_purged_junior_army_officers_2
			}
		}
		else = {
			add_ideas = SOV_purged_junior_army_officers_1
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}
		
		#PARANOIA decreases
		SOV_paranoia_medium_decrease_effect = yes

		if = {
			limit = {
				has_country_flag = SOV_purge_event_unavoidable_flag
			}
			custom_effect_tooltip = SOV_purge_event_unavoidable_purge_great_tt
		}
		else_if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}

		#Clear flags forbidding the "avoid purge" option from showing up
		SOV_clear_unavoidable_purge_flags_effect = yes
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.28.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
			NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } #Used for historical purges triggered via focus
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA INCREASES
		SOV_paranoia_high_increase_effect = yes
	}
}

### GREAT PURGE TRIAL OF THE GENERALS - ARMY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.29
	title = NSB_soviet_paranoia_system_events.29.t
	desc = NSB_soviet_paranoia_system_events.29.desc
	picture = GFX_report_event_soviet_purge_officers_01
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = { #PURGE THEM!!
		name = NSB_soviet_paranoia_system_events.29.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			#Purge any Advisors
			every_character = {
				limit = {
					has_army_ledger = yes
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes	
				log = "Hey I am [THIS.GetName] I am in the Event!"
			}

			#Purge any Marshals/Generals #This is a duplicate as a workaround for tooltip purposes
			every_army_leader = {
				limit = {
					OR = {
						is_field_marshal = yes
						is_corps_commander = yes
					}
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes	
				log = "Hey I am [THIS.GetName] I am in the Event!"
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#RANDOM GENERALS COWED
		SOV_paranoia_daunt_generals_effect = yes

		#PARANOIA decreases
		SOV_paranoia_very_high_decrease_effect = yes

		if = {
			limit = {
				has_country_flag = SOV_purge_event_unavoidable_flag
			}
			custom_effect_tooltip = SOV_purge_event_unavoidable_purge_great_tt
		}
		else_if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}

		#Clear flags forbidding the "avoid purge" option from showing up
		SOV_clear_unavoidable_purge_flags_effect = yes 
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.29.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
			NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } #Used for historical purges triggered via focus
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA INCREASES
		SOV_paranoia_very_high_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
	}
}

###################
### NAVY PURGES ###
###################

### ADMIRAL ACCUSED OF TREASON - NAVY ###
unit_leader_event = {
	id = NSB_soviet_paranoia_system_events.31
	title = NSB_soviet_paranoia_system_events.31.t
	desc = NSB_soviet_paranoia_system_events.31.desc
	picture = GFX_report_event_soviet_purge_trial
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.31.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			random_navy_leader = {
				limit = {
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes
			}
		}
		#custom_effect_tooltip = SOV_retire_purged_character_tt
		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#RANDOM ADMIRALS COWED
		SOV_paranoia_daunt_admirals_minor_effect = yes

		#PARANOIA DECREASES based on general's level
		set_variable = { SOV_unit_leader_level = SOV_accused_unit_leader_level } #Set the appropriate var used in the scripted effect
		SOV_paranoia_decrease_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_accused_decrease_tt

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
		clear_variable = SOV_purged_character_for_loc 
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.21.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA INCREASES
		set_variable = { SOV_unit_leader_level = SOV_accused_unit_leader_level } #Set the appropriate var used in the scripted effect
		SOV_paranoia_increase_based_on_unit_leader_level_effect = yes
		custom_effect_tooltip = NSB_soviet_paranoia_system_events.24_paranoia_accused_increase_tt

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
		clear_variable = SOV_purged_character_for_loc
	}
}

### CONSPIRACY IN THE ACADEMY - NAVY ###
#Loc taken from the Army event
country_event = {
	id = NSB_soviet_paranoia_system_events.32
	title = NSB_soviet_paranoia_system_events.22.t
	desc = NSB_soviet_paranoia_system_events.22.desc
	picture = GFX_report_event_SOV_purge_administration
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.22.a
		ai_chance = {
			base = 10
		}

		add_ideas = SOV_anti_soviet_military_thinking_banned_navy

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_medium_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}	
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.22.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
	}
}

### ANTI-SABOTEUR CAMPAIGN - NAVY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.33
	title = NSB_soviet_paranoia_system_events.23.t
	desc = NSB_soviet_paranoia_system_events.33.desc
	picture = GFX_report_event_SOV_purge_navy
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.23.a
		ai_chance = {
			base = 10
		}

		add_timed_idea = {
			idea = SOV_shipyard_staff_purged
			days = 365
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_medium_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}

		# Increase opposition Navy Support 
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.23.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
	}
}

### GREAT PURGE - JUNIOR NAVY OFFICERS - NAVY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.38
	title = NSB_soviet_paranoia_system_events.38.t
	desc = NSB_soviet_paranoia_system_events.38.desc
	picture = GFX_report_event_SOV_purge_young_officers
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.28.a
		ai_chance = {
			base = 10
		}

		if = {
			limit = {
				has_idea = SOV_purged_junior_navy_officers_3
			}
			# NOTHING HAPPENS, but this should not be a possibility
			log = "I CAN'T MAKE THIS WORSE FOR GODS SAKE!"
		}
		else_if = {
			limit = {
				has_idea = SOV_purged_junior_navy_officers_2
			}
			swap_ideas = {
				remove_idea = SOV_purged_junior_navy_officers_2
				add_idea = SOV_purged_junior_navy_officers_3
			}
		}
		else_if = {
			limit = {
				has_idea = SOV_purged_junior_navy_officers_1
			}
			swap_ideas = {
				remove_idea = SOV_purged_junior_navy_officers_1
				add_idea = SOV_purged_junior_navy_officers_2
			}
		}
		else = {
			add_ideas = SOV_purged_junior_navy_officers_1
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_low_decrease_effect = yes

		if = {
			limit = {
				has_country_flag = SOV_purge_event_unavoidable_flag
			}
			custom_effect_tooltip = SOV_purge_event_unavoidable_purge_great_tt
		}
		else_if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}

		#Clear flags forbidding the "avoid purge" option from showing up
		SOV_clear_unavoidable_purge_flags_effect = yes	

		# Increase opposition Navy Support 
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.28.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
			NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } #Used for historical purges triggered via focus
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA increases
		SOV_paranoia_high_increase_effect = yes
	}
}

### GREAT PURGE - TRIAL OF THE ADMIRALS - NAVY ###
country_event = {
	id = NSB_soviet_paranoia_system_events.39
	title = NSB_soviet_paranoia_system_events.39.t
	desc = NSB_soviet_paranoia_system_events.39.desc
	picture = GFX_report_event_SOV_purge_navy
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = { #PURGE
		name = NSB_soviet_paranoia_system_events.29.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			#Purge any Advisors
			every_character = {
				limit = {
					has_navy_ledger = yes
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes	
			}

			#Purge any Admirals # This is a duplicate as a workaround for tooltip purposes
			every_navy_leader = {
				limit = {
					has_character_flag = SOV_targeted_for_purge_flag
				}
				SOV_purge_character_effect = yes	
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#RANDOM ADMIRALS COWED
		SOV_paranoia_daunt_admirals_effect = yes

		#PARANOIA decreases
		SOV_paranoia_very_high_decrease_effect = yes

		if = {
			limit = {
				has_country_flag = SOV_purge_event_unavoidable_flag
			}
			custom_effect_tooltip = SOV_purge_event_unavoidable_purge_great_tt
		}
		else_if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}

		#Clear flags forbidding the "avoid purge" option from showing up
		SOV_clear_unavoidable_purge_flags_effect = yes 
	}

	option = { #NO WAIT! Let's Think about it
		name = NSB_soviet_paranoia_system_events.29.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
			NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } #Used for historical purges triggered via focus
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA increases
		SOV_paranoia_very_high_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
	}
}


#######################
### AIRFORCE PURGES ###
#######################

### CONSPIRACY IN THE ACADEMY - AIRFORCE ###
country_event = {
	id = NSB_soviet_paranoia_system_events.41
	title = NSB_soviet_paranoia_system_events.22.t
	desc = NSB_soviet_paranoia_system_events.22.desc
	picture = GFX_report_event_SOV_purge_administration
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.22.a
		ai_chance = {
			base = 10
		}

		add_ideas = SOV_anti_soviet_military_thinking_banned_airforce

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_medium_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.22.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes
	}
}

#### ANTI-SABOTEUR CAMPAIGN - AIRFORCE ###
country_event = {
	id = NSB_soviet_paranoia_system_events.42
	title = NSB_soviet_paranoia_system_events.23.t
	desc = NSB_soviet_paranoia_system_events.42.desc
	picture = GFX_report_event_SOV_purge_aircraft_2
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_regular = yes
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.23.a
		ai_chance = {
			base = 10
		}

		add_timed_idea = {
			idea = SOV_ground_based_training
			days = 365
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_medium_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_regular
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_regular_tt
		}	
	}

	option = {
		name = NSB_soviet_paranoia_system_events.23.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_regular_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_regular }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_regular_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes
	}
}

### GREAT PURGE - DESIGN BUREAU DISSOLVED - AIRFORCE ###
country_event = {
	id = NSB_soviet_paranoia_system_events.48
	title = NSB_soviet_paranoia_system_events.48.t
	desc = NSB_soviet_paranoia_system_events.48.desc
	picture = GFX_report_event_SOV_purge_aircraft_1
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = {
		name = NSB_soviet_paranoia_system_events.48.a
		ai_chance = {
			base = 10
		}

		if = {
			limit = { # MIG
				check_variable = {
					var = SOV_random_bureau_to_dissolve
					value = 0.75
					compare = greater_than_or_equals 
				}
			}
			remove_ideas = SOV_mig_design_bureau
			set_country_flag = SOV_mig_design_bureau_dissolved_flag
			unlock_decision_tooltip = SOV_reinstate_mig_design_bureau
		}
		else_if = {
			limit = { # ILYUSHIN
				check_variable = {
					var = SOV_random_bureau_to_dissolve
					value = 0.5
					compare = greater_than_or_equals 
				}
			}
			remove_ideas = SOV_ilyushin_design_bureau
			set_country_flag = SOV_ilyushin_design_bureau_dissolved_flag
			unlock_decision_tooltip = SOV_reinstate_ilyushin_design_bureau
		}
		else_if = {
			limit = { # TUPOLEV
				check_variable = {
					var = SOV_random_bureau_to_dissolve
					value = 0.25
					compare = greater_than_or_equals 
				}
			}
			remove_ideas = SOV_tupolev_design_bureau
			set_country_flag = SOV_tupolev_design_bureau_dissolved_flag
			unlock_decision_tooltip = SOV_reinstate_tupolev_design_bureau
		}
		else= { #YAKOVLEV
			remove_ideas = SOV_yakovlev_design_bureau
			set_country_flag = SOV_yakovlev_design_bureau_dissolved_flag
			unlock_decision_tooltip = SOV_reinstate_yakovlev_design_bureau
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		#PARANOIA decreases
		SOV_paranoia_very_high_decrease_effect = yes

		if = {
			limit = {
				has_country_flag = SOV_purge_event_unavoidable_flag
			}
			custom_effect_tooltip = SOV_purge_event_unavoidable_purge_great_tt
		}
		else_if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}
		
		#Clear flags forbidding the "avoid purge" option from showing up
		SOV_clear_unavoidable_purge_flags_effect = yes
	}

	option = {
		name = NSB_soviet_paranoia_system_events.48.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
			NOT = { has_country_flag = SOV_purge_event_unavoidable_flag } #Used for historical purges triggered via focus
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA increases
		SOV_paranoia_very_high_increase_effect = yes
	}
}

### GREAT PURGE - AIRFORCE CHIEFS - AIRFORCE ###
country_event = {
	id = NSB_soviet_paranoia_system_events.49
	title = NSB_soviet_paranoia_system_events.49.t
	desc = NSB_soviet_paranoia_system_events.49.desc
	picture = GFX_report_event_soviet_purge_trial
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_country_flag = SOV_purged_airforce_chiefs_flag }
				}
				set_country_flag = SOV_purged_airforce_chiefs_flag
			}		
			SOV_paranoia_increase_purge_counter_great = yes
		}
	}

	option = { #PURGE MODE ON
		name = NSB_soviet_paranoia_system_events.49.a
		ai_chance = {
			base = 10
		}

		hidden_effect = {
			every_character = {
				limit = {
					has_character_flag = SOV_targeted_for_purge_flag
					has_air_ledger = yes
				}
				SOV_purge_character_effect = yes
			}
		}

		#Update purged portraits in UI
		hidden_effect = {
			SOV_paranoia_update_portraits_ui = yes
		}

		custom_effect_tooltip = SOV_characters_will_be_purged_tt
		character_list_tooltip = {
			limit = {
				has_character_flag = SOV_targeted_for_purge_flag
			}
		}

		#PARANOIA decreases
		SOV_paranoia_high_decrease_effect = yes

		if = {
			limit = {
				has_political_power < SOV_purge_event_pp_to_avoid_great
			}
			custom_effect_tooltip = SOV_purge_event_not_enough_pp_to_avoid_great_tt
		}
	}

	option = { #PURGE MODE OFF
		name = NSB_soviet_paranoia_system_events.49.b
		ai_chance = {
			base = 1
			modifier = { #Don't go to negative PP please
				factor = 0
				has_political_power < SOV_purge_event_pp_to_avoid_great_pay
			}
		}

		trigger = {
			NOT = { has_political_power < SOV_purge_event_pp_to_avoid_great }
		}

		add_political_power = SOV_purge_event_pp_to_avoid_great_pay

		#PARANOIA increases
		SOV_paranoia_low_increase_effect = yes

		#CLEAN EVERYTHING THANKS
		SOV_clean_purge_targets_effect = yes
	}
}



########  ########   #######  ########     ###     ######      ###    ##    ## ########     ###    
##     ## ##     ## ##     ## ##     ##   ## ##   ##    ##    ## ##   ###   ## ##     ##   ## ##   
##     ## ##     ## ##     ## ##     ##  ##   ##  ##         ##   ##  ####  ## ##     ##  ##   ##  
########  ########  ##     ## ########  ##     ## ##   #### ##     ## ## ## ## ##     ## ##     ## 
##        ##   ##   ##     ## ##        ######### ##    ##  ######### ##  #### ##     ## ######### 
##        ##    ##  ##     ## ##        ##     ## ##    ##  ##     ## ##   ### ##     ## ##     ## 
##        ##     ##  #######  ##        ##     ##  ######   ##     ## ##    ## ########  ##     ## 


#Propaganda Dispatcher - Left Slot - Used to update Campaign GFX when it's old.
country_event = {
	id = NSB_soviet_propaganda_capmaign_events.101
	title = NSB_soviet_propaganda_capmaign_events.101.t
	desc = NSB_soviet_propaganda_capmaign_events.101.desc
	
	is_triggered_only = yes

	trigger = {
		check_variable = { SOV_propaganda_left_poster_to_age = SOV_poster_left_icon_frame } #So that this does not happen if a propaganda is cancelled, breaking everything
	}

	hidden = yes

	immediate = {
		set_country_flag = SOV_propaganda_left_slot_is_old_flag
		#log = "I AM HERE: LEFT FRAME IS [?SOV_poster_left_icon_frame] // POSTER TO AGE IS [?SOV_propaganda_left_poster_to_age]" #Debug
	}
}

#Propaganda Dispatcher - Center Slot - Used to update Campaign GFX when it's old.
country_event = {
	id = NSB_soviet_propaganda_capmaign_events.102
	title = NSB_soviet_propaganda_capmaign_events.102.t
	desc = NSB_soviet_propaganda_capmaign_events.102.desc
	
	is_triggered_only = yes

	trigger = {
		check_variable = { SOV_propaganda_center_poster_to_age = SOV_poster_center_icon_frame } #So that this does not happen if a propaganda is cancelled, breaking everything
	}

	hidden = yes

	immediate = {
		set_country_flag = SOV_propaganda_center_slot_is_old_flag
		#log = "I AM HERE: CENTER FRAME IS [?SOV_poster_center_icon_frame] // POSTER TO AGE IS [?SOV_propaganda_center_poster_to_age]" #Debug
	}
}

#Propaganda Dispatcher - Right Slot - Used to update Campaign GFX when it's old.
country_event = {
	id = NSB_soviet_propaganda_capmaign_events.103
	title = NSB_soviet_propaganda_capmaign_events.103.t
	desc = NSB_soviet_propaganda_capmaign_events.103.desc
	
	is_triggered_only = yes

	trigger = {
		check_variable = { SOV_propaganda_right_poster_to_age = SOV_poster_right_icon_frame } #So that this does not happen if a propaganda is cancelled, breaking everything
	}

	hidden = yes

	immediate = {
		set_country_flag = SOV_propaganda_right_slot_is_old_flag
		#log = "I AM HERE: RIGHT FRAME IS [?SOV_poster_right_icon_frame] // POSTER TO AGE IS [?SOV_propaganda_right_poster_to_age]" #Debug
	}
}

# YOUNG BUILDERS OF COMMUNISM - event for SOV's puppets
country_event = {
	id = NSB_soviet_propaganda_capmaign_events.1
	title = NSB_soviet_propaganda_capmaign_events.1.t
	desc = NSB_soviet_propaganda_capmaign_events.1.desc
	picture = GFX_report_event_SOV_young_builders_of_communism
	
	is_triggered_only = yes

	option = { #OK
		name = NSB_soviet_propaganda_capmaign_events.1.a

		add_timed_idea = {
			idea = SOV_young_builders_of_communism
			days = SOV.SOV_default_propaganda_campaign_duration
		}
	}
}

# LONG LIVE TO PEACE - event for SOV (peace broken as attacker)
country_event = {
	id = NSB_soviet_propaganda_capmaign_events.2
	title = NSB_soviet_propaganda_capmaign_events.2.t
	desc = NSB_soviet_propaganda_capmaign_events.2.desc
	picture = GFX_report_event_SOV_young_builders_of_communism
	
	is_triggered_only = yes

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			set_country_flag = SOV_punished_for_breaking_flag
			add_timed_idea = {
				idea = SOV_broken_peace_dreams_attacker
				days = 180
			}
			#RESET PROPAGANDA CAMPAIGN
			set_rule = { can_send_volunteers = yes }
			clr_country_flag = SOV_propaganda_peace_active_flag
			set_variable = { SOV_propaganda_campaign_to_remove = 25 }
			SOV_reset_propaganda_campaign_slot_effect = yes
		}
	}

	option = { #OK
		name = NSB_soviet_propaganda_capmaign_events.2.a

		effect_tooltip = {
			add_timed_idea = {
				idea = SOV_broken_peace_dreams_attacker
				days = 180
			}
		}
	}
}

# LONG LIVE TO PEACE - event for SOV (peace broken as defender)
country_event = {
	id = NSB_soviet_propaganda_capmaign_events.3
	title = NSB_soviet_propaganda_capmaign_events.2.t
	desc = NSB_soviet_propaganda_capmaign_events.3.desc
	picture = GFX_report_event_SOV_young_builders_of_communism

	is_triggered_only = yes

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			set_country_flag = SOV_punished_for_breaking_flag
			add_timed_idea = {
				idea = SOV_broken_peace_dreams_defender
				days = 180
			}
			#RESET PROPAGANDA CAMPAIGN
			set_rule = { can_send_volunteers = yes }
			clr_country_flag = SOV_propaganda_peace_active_flag
			set_variable = { SOV_propaganda_campaign_to_remove = 25 }
			SOV_reset_propaganda_campaign_slot_effect = yes
		}
	}

	option = { #OK
		name = NSB_soviet_propaganda_capmaign_events.3.a

		effect_tooltip = {
			add_timed_idea = {
				idea = SOV_broken_peace_dreams_defender
				days = 180
			}
		}
	}
}


########  #######  ########  ######## ####  ######   ##    ##    ########   #######  ##       #### ######## ####  ######   ######  
##       ##     ## ##     ## ##        ##  ##    ##  ###   ##    ##     ## ##     ## ##        ##     ##     ##  ##    ## ##    ## 
##       ##     ## ##     ## ##        ##  ##        ####  ##    ##     ## ##     ## ##        ##     ##     ##  ##       ##       
######   ##     ## ########  ######    ##  ##   #### ## ## ##    ########  ##     ## ##        ##     ##     ##  ##        ######  
##       ##     ## ##   ##   ##        ##  ##    ##  ##  ####    ##        ##     ## ##        ##     ##     ##  ##             ## 
##       ##     ## ##    ##  ##        ##  ##    ##  ##   ###    ##        ##     ## ##        ##     ##     ##  ##    ## ##    ## 
##        #######  ##     ## ######## ####  ######   ##    ##    ##         #######  ######## ####    ##    ####  ######   ######  

# SOV is pressuring our government - Event for Targeted country
country_event = {
	id = NSB_soviet_foreign_politics_events.1
	title = NSB_soviet_foreign_politics_events.1.t
	desc = NSB_soviet_foreign_politics_events.1.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes

	#immediate = { #Debug
	#	log = "FROM is [FROM.GetName]"
	#	log = "FROM.FROM [FROM.FROM.GetName]"
	#	log = "FROM.PREV [FROM.PREV.GetName]"
	#	log = "FROM.FROM.PREV [FROM.FROM.PREV.GetName]"
	#	log = "ROOT.FROM [ROOT.FROM.GetName]"
	#	log = "ROOT.PREV [ROOT.PREV.GetName]"
	#}

	option = { #Join Faction - Keep government
		name = NSB_soviet_foreign_politics_events.1.a

		ai_chance = {
			base = 10
			modifier = {
				factor = 2
				strength_ratio = {
					tag = FROM
					ratio < 0.5
				}
			}
			modifier = {
				factor = 4
				strength_ratio = {
					tag = FROM
					ratio < 0.2
				}
			}
			modifier = {
				factor = 2
				has_opinion = {
					target = FROM
					value > 75
				}
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 2
				SOV = { has_idea = SOV_maksim_litvinov }
			}
			modifier = {
				factor = 0
				OR = {
					is_in_faction = yes
					is_subject = yes
				}
			}
		}

		trigger = {
			NOT = { is_in_faction_with = FROM }
		}

		FROM = { add_to_faction = ROOT }
		add_opinion_modifier = {
			target = FROM
			modifier = SOV_pressured_our_government
		}
		hidden_effect = {
			country_event = { id = NSB_soviet_foreign_politics_events.151 hours = 1 }
		}
	}

	option = { #Change Government
		name = NSB_soviet_foreign_politics_events.1.b

		ai_chance = {
			base = 10
			modifier = {
				factor = 5
				OR = {
					FROM = {
						has_government = communism
						communism > 0.5
					}
					FROM = {
						has_government = democratic
						democratic > 0.5
					}
					FROM = {
						has_government = fascism
						fascism > 0.5
					}
					FROM = {
						has_government = neutrality
						neutrality > 0.5
					}
				}
			}
			modifier = {
				factor = 2
				has_opinion = {
					target = FROM
					value > 75
				}
			}
			modifier = {
				factor = 0
				OR = {
					is_in_faction = yes
					is_subject = yes
				}
			}
		}

		trigger = {
			NOT = { has_government = FROM }
		}

		set_politics = { ruling_party = FROM }
		add_opinion_modifier = {
			target = FROM
			modifier = SOV_pressured_our_government
		}
		hidden_effect = {
			country_event = { id = NSB_soviet_foreign_politics_events.158 hours = 1 }
		}
	}

	option = { #REFUSE
		name = NSB_soviet_foreign_politics_events.1.c

		ai_chance = {
			base = 10
			modifier = {
				factor = 2
				any_country = {
					is_major = yes
					has_guaranteed = ROOT
				}
			}
			modifier = {
				factor = 1.2
				any_country = {
					is_major = no
					has_guaranteed = ROOT
				}
			}
		}

		add_popularity = {
			ideology = FROM
			popularity = 0.05
		}
		add_opinion_modifier = {
			target = FROM
			modifier = SOV_pressured_our_government
		}
		hidden_effect = {
			country_event = { id = NSB_soviet_foreign_politics_events.152 hours = 1 }
		}
	}
}

# SOV is promoting ideology rallies - Event for Targeted country
country_event = {
	id = NSB_soviet_foreign_politics_events.2
	title = NSB_soviet_foreign_politics_events.2.t
	desc = NSB_soviet_foreign_politics_events.2.desc
	picture = GFX_report_event_soviet_purge_speech

	is_triggered_only = yes

	immediate = {
		log = "FROM is [FROM.GetName]"
		log = "FROM.FROM [FROM.FROM.GetName]"
		log = "FROM.PREV [FROM.PREV.GetName]"
		log = "FROM.FROM.PREV [FROM.FROM.PREV.GetName]"
		log = "ROOT.FROM [ROOT.FROM.GetName]"
		log = "ROOT.PREV [ROOT.PREV.GetName]"
	}

	option = { #OK
		name = NSB_soviet_foreign_politics_events.2.a

		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				strength_ratio = {
					tag = FROM
					ratio < 0.5
				}
			}
			modifier = {
				factor = 5
				strength_ratio = {
					tag = FROM
					ratio < 0.2
				}
			}
			modifier = {
				factor = 1.5
				has_opinion = {
					target = FROM
					value > 75
				}
			}
			modifier = {
				factor = 0
				OR = {
					is_in_faction = yes
					is_subject = yes
				}
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 2
				SOV = { has_idea = SOV_maksim_litvinov }
			}
		}

		hidden_effect = { #Country is slightly more willing to cooperate with Soviets
			add_ai_strategy = {
				type = befriend
				id = SOV			
				value = 10
			}
			add_ai_strategy = {
				type = alliance
				id = SOV			
				value = 10
			}
		}

		add_popularity = {
			ideology = FROM
			popularity = 0.1
		}
		add_opinion_modifier = {
			target = FROM
			modifier = SOV_stirring_the_masses
		}
	}

	option = { #Prevent it!
		name = NSB_soviet_foreign_politics_events.2.b

		ai_chance = {
			base = 10
			modifier = {
				factor = 0
				has_political_power < 70
			}
		}

		trigger = {
			NOT = { has_government = FROM }
		}

		add_political_power = -70
		add_stability = -0.05
		add_popularity = {
			ideology = ROOT
			popularity = 0.1
		}
		add_opinion_modifier = {
			target = FROM
			modifier = SOV_stirring_the_masses
		}
	}
}


# SOV is investing in developing our country - Event for minor Asian allies
country_event = {
	id = NSB_soviet_foreign_politics_events.10
	title = NSB_soviet_foreign_politics_events.10.t
	desc = NSB_soviet_foreign_politics_events.10.desc
	picture = GFX_report_event_china_ledo_road

	is_triggered_only = yes
			
	option = { #Ok
		name = NSB_soviet_foreign_politics_events.10.a
	
		ai_chance = { base = 1 }

		#CAPITAL
		capital_scope = {
			if = {
				limit = {
					infrastructure < 4
				}
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			else_if = {
				limit = {
					infrastructure < 5
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			if = {
				limit = {
					free_building_slots = {
						building = industrial_complex
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			else_if = {
				limit = {
					free_building_slots = {
						building = industrial_complex
						size > 0
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}		
		}

		#ADDITIONAL RANDOM STATE
		if = {
			limit = {
				any_owned_state = {
					is_capital = no
				}
			}
			random_owned_state = {
				limit = {
					is_capital = no
				}
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				if = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}		
			}
		}
	}

	option = { #Refuse
		name = NSB_soviet_foreign_politics_events.10.b

		ai_chance = { base = 0 }

		FROM = {
			add_opinion_modifier = {
				target = ROOT
				modifier = SOV_refused_to_follow_our_guidelines
			}
		}
		FROM = { country_event = { id = NSB_soviet_foreign_politics_events.13 hours = 8 random_hours = 4 } }
	}
}

# SOV wants us to follow war measures - Event for minor Asian allies
country_event = {
	id = NSB_soviet_foreign_politics_events.11
	title = NSB_soviet_foreign_politics_events.11.t
	desc = NSB_soviet_foreign_politics_events.11.desc
	picture = GFX_report_event_SOV_mongolia_cavalry

	is_triggered_only = yes
			
	option = { #Ok
		name = NSB_soviet_foreign_politics_events.11.a
	
		ai_chance = { base = 1 }

		add_timed_idea = { idea = SOV_war_measures_allies days = 1095 }
	}

	option = { #Refuse
		name = NSB_soviet_foreign_politics_events.11.b
		
		ai_chance = { base = 0 }
		
		FROM = {
			add_opinion_modifier = {
				target = ROOT
				modifier = SOV_refused_to_follow_our_guidelines
			}
		}
		FROM = { country_event = { id = NSB_soviet_foreign_politics_events.13 hours = 8 random_hours = 4 } }
	}
}
# Our ally rejects our guidelines - Event for SOV (when any of the three events above are refused by a PLAYER)
country_event = {
	id = NSB_soviet_foreign_politics_events.13
	title = NSB_soviet_foreign_politics_events.13.t
	desc = NSB_soviet_foreign_politics_events.13.desc
	picture = GFX_report_event_stalin_meeting

	is_triggered_only = yes
			
	option = { #Refuse
		name = NSB_soviet_foreign_politics_events.13.a
				
		effect_tooltip = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_refused_to_follow_our_guidelines
			}
		}
	}
}

# SOV sends military advisors - Event for SPR
country_event = {
	id = NSB_soviet_foreign_politics_events.20
	title = NSB_soviet_foreign_politics_events.20.t
	desc = NSB_soviet_foreign_politics_events.20.desc
	picture = GFX_report_event_spr_spanish_civil_war

	is_triggered_only = yes
			
	option = { #Ok
		name = NSB_soviet_foreign_politics_events.20.a
		
		add_timed_idea = {idea = SOV_soviet_advisors_spr days = 1095 }
		effect_tooltip = {
			FROM = {
				add_timed_idea = {idea = SOV_military_advisors_in_spain days = 1095 }
			}
		}
	}
}

# Country becomes a puppet - Event for SOV
country_event = {
	id = NSB_soviet_foreign_politics_events.150
	title = NSB_soviet_foreign_politics_events.150.t
	desc = NSB_soviet_foreign_politics_events.150.desc
	picture = GFX_report_event_stalin_propaganda

	is_triggered_only = yes
			
	option = { #Cool
		name = NSB_soviet_foreign_politics_events.150.a
		effect_tooltip = {
			set_politics = { ruling_party = ROOT }
			puppet = FROM
			add_to_faction = FROM
		}
	}
}

# Country joins faction - Event for SOV
country_event = {
	id = NSB_soviet_foreign_politics_events.151
	title = NSB_soviet_foreign_politics_events.151.t
	desc = NSB_soviet_foreign_politics_events.151.desc
	picture = GFX_report_event_stalin_propaganda

	is_triggered_only = yes
			
	option = { #Okay
		name = NSB_soviet_foreign_politics_events.151.a
		effect_tooltip = {
			add_to_faction = FROM
			FROM = {
				add_opinion_modifier = {
					target = ROOT
					modifier = SOV_pressured_our_government
				}
			}
		}
	}
}

# Country changes government - Event for SOV
country_event = {
	id = NSB_soviet_foreign_politics_events.158
	title = NSB_soviet_foreign_politics_events.158.t
	desc = NSB_soviet_foreign_politics_events.158.desc
	picture = GFX_report_event_stalin_propaganda

	is_triggered_only = yes

	option = { #Okay
		name = NSB_soviet_foreign_politics_events.158.a
		effect_tooltip = {
			FROM = {
				set_politics = { ruling_party = ROOT }
				add_opinion_modifier = {
					target = ROOT
					modifier = SOV_pressured_our_government
				}
			}
		}
	}
}

# Country refuses - Event for SOV
country_event = {
	id = NSB_soviet_foreign_politics_events.152
	title = NSB_soviet_foreign_politics_events.152.t
	desc = NSB_soviet_foreign_politics_events.152.desc
	picture = GFX_report_event_generic_sign_treaty1

	is_triggered_only = yes
			
	option = { #Okay - Default generic option
		name = NSB_soviet_foreign_politics_events.152.a

		ai_chance = {
			base = 1
		}

		trigger = {
			NOT = { FROM = { original_tag = PER } }
		}

		effect_tooltip = {
			create_wargoal = {
				type = puppet_wargoal_focus
				target = FROM
			}
			FROM = {
				add_opinion_modifier = {
					target = ROOT
					modifier = SOV_pressured_our_government
				}
			}
		}
	}

	option = { #Respect
		name = NSB_soviet_foreign_politics_events.152.b
		
		ai_chance = {
			base = 0
			modifier = {
				add = 1
				FROM = { original_tag = PER }
			}
		}
	}
}

# HIDDEN EVENT TO MANAGE THE FALL OF IRAN - ONLY SOVIETS
country_event = {
	id = NSB_soviet_foreign_politics_events.156

	is_triggered_only = yes

	hidden = yes

	immediate = {
		transfer_state = 419 #Tibriz (AZB)
		transfer_state = 420 #Gilan (AZB)
		transfer_state = 416 #Khorasan
		PER = {
			give_resource_rights = { receiver = SOV state = 411 }
			give_resource_rights = { receiver = SOV state = 412 }
			give_resource_rights = { receiver = SOV state = 413 }
		}
		411 = { set_state_flag = SOV_soviet_resource_rights_iran_flag }
		412 = { set_state_flag = SOV_soviet_resource_rights_iran_flag }
		413 = { set_state_flag = SOV_soviet_resource_rights_iran_flag }
	}
}

# HIDDEN EVENT TO MANAGE THE FALL OF IRAN - JOINT INVASION
country_event = {
	id = NSB_soviet_foreign_politics_events.157

	is_triggered_only = yes

	hidden = yes

	immediate = {
		transfer_state = 419 #Tibriz (AZB)
		transfer_state = 420 #Gilan (AZB)
		transfer_state = 416 #Khorasan
		PER = {
			give_resource_rights = { receiver = SOV state = 411 }
			give_resource_rights = { receiver = SOV state = 412 }
			give_resource_rights = { receiver = ENG state = 413 }
			give_military_access = ROOT
		}
		411 = { set_state_flag = SOV_soviet_resource_rights_iran_flag }
		412 = { set_state_flag = SOV_soviet_resource_rights_iran_flag }
		413 = { set_state_flag = SOV_british_resource_rights_iran_flag }
	}
}

# Generic Ultimatum - Event for target
country_event = {
	id = NSB_soviet_foreign_politics_events.200
	title = NSB_soviet_foreign_politics_events.200.t
	desc = NSB_soviet_foreign_politics_events.200.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes

	immediate = {
		log = "FROM is [FROM.GetName]"
		log = "FROM.FROM [FROM.FROM.GetName]"
		log = "FROM.PREV [FROM.PREV.GetName]"
		log = "FROM.FROM.PREV [FROM.FROM.PREV.GetName]"
		log = "ROOT.FROM [ROOT.FROM.GetName]"
		log = "ROOT.PREV [ROOT.PREV.GetName]"
	}
			
	option = { # Become a puppet
		name = NSB_soviet_foreign_politics_events.200.a

		ai_chance = {
			base = 2
			modifier = {
				factor = 1.5
				has_opinion = {
					target = FROM
					value > 75
				}
			}
			modifier = {
				factor = 1.5
				OR = {
					AND = {
						FROM = {
							has_government = communism
						}
						communism > 0.5
					}
					AND = {
						FROM = {
							has_government = democratic
						}
						democratic > 0.5
					}
					AND = {
						FROM = {
							has_government = fascism
						}
						fascism > 0.5
					}
					AND = {
						FROM = {
							has_government = neutrality
						}
						neutrality > 0.5
					}
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = FROM
					ratio < 0.8
				}
			}
			modifier = {
				factor = 4
				strength_ratio = {
					tag = FROM
					ratio < 0.5
				}
			}
			modifier = {
				factor = 6
				strength_ratio = {
					tag = FROM
					ratio < 0.2
				}
			}
			modifier = {
				factor = 100
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0
				OR = {
					AND = {
						is_in_faction = yes
						NOT = { is_in_faction_with = FROM }
					}
					AND = {
						is_subject = yes
						NOT = { is_subject_of = FROM }
					}
				}
			}
		}

		trigger = {
			has_government = FROM
		}

		set_politics = { ruling_party = FROM }
		FROM = {
			puppet = ROOT
			add_to_faction = ROOT
			hidden_effect = {
				country_event = { id = NSB_soviet_foreign_politics_events.150 hours = 1 }
			}
		}
		#TODO_Manu: Handle wars, civil wars and all that stuff
	}

	option = { #Join Faction - Keep government
		name = NSB_soviet_foreign_politics_events.200.b

		ai_chance = {
			base = 0
		}

		FROM = {
			add_to_faction = ROOT
			hidden_effect = {
				country_event = { id = NSB_soviet_foreign_politics_events.151 hours = 1 }
			}
		}
		hidden_effect = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_pressured_our_government
			}
		}
	}

	option = { #REFUSE
		name = NSB_soviet_foreign_politics_events.200.c

		ai_chance = {
			base = 10
		}

		FROM = {
			create_wargoal = {
				type = puppet_wargoal_focus
				target = ROOT
			}
			hidden_effect = {
				country_event = { id = NSB_soviet_foreign_politics_events.152 hours = 1 }
			}
		}

		hidden_effect = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_pressured_our_government
			}
		}
	}
}

# Ultimatum to Iran - Event for Iran
country_event = {
	id = NSB_soviet_foreign_politics_events.210
	title = NSB_soviet_foreign_politics_events.210.t
	desc = NSB_soviet_foreign_politics_events.210.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes
			
	option = { # Become a puppet
		name = NSB_soviet_foreign_politics_events.210.a

		ai_chance = {
			base = 1
			modifier = {
				add = 0.5
				has_opinion = {
					target = FROM
					value > 75
				}
			}
			modifier = {
				add = 0.5
				OR = {
					FROM = {
						has_government = communism
						communism > 0.5
					}
					FROM = {
						has_government = democratic
						democratic > 0.5
					}
					FROM = {
						has_government = fascism
						fascism > 0.5
					}
					FROM = {
						has_government = neutrality
						neutrality > 0.5
					}
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = FROM
					ratio < 0.8
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = FROM
					ratio < 0.5
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = FROM
					ratio < 0.2
				}
			}
			modifier = {
				factor = 100
				is_in_faction_with = FROM
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 1.5
				SOV = { has_idea = SOV_maksim_litvinov }
			}
			modifier = {
				factor = 0
				OR = {
					AND = {
						is_in_faction = yes
						NOT = { is_in_faction_with = FROM }
					}
					AND = {
						is_subject = yes
						NOT = { is_subject_of = FROM }
					}
				}
			}
		}

		set_politics = { ruling_party = FROM }
		FROM = {
			puppet = ROOT
			add_to_faction = ROOT
			hidden_effect = {
				country_event = { id = NSB_soviet_foreign_politics_events.150 hours = 1 }
			}
		}
		#TODO_Manu: Handle wars, civil wars and all that stuff
	}

	option = { #REFUSE
		name = NSB_soviet_foreign_politics_events.210.c

		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				is_historical_focus_on = yes
			}
		}

		FROM = {
			hidden_effect = {
				country_event = { id = NSB_soviet_foreign_politics_events.152 hours = 1 }
			}
		}

		hidden_effect = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_pressured_our_government
			}
		}

		custom_effect_tooltip = germany.126.warning
	}
}
# SOV sends Infantry Equipment - Event for Target
country_event = {
	id = NSB_soviet_foreign_politics_events.250
	title = NSB_soviet_foreign_politics_events.250.t
	desc = NSB_soviet_foreign_politics_events.250.desc
	picture = "[GetInfantryEquipmentGFX]"

	is_triggered_only = yes
			
	option = { # Nice
		name = NSB_soviet_foreign_politics_events.10.a
		
		if = { #Spanish POUM -> Not actually transfering them, just creating spoawning them
			limit = {
				tag = SPC
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = 6000
				producer = FROM
			}
		}
		else = { #Chinese tags get different stuff -> SOV actually sends stuff
			effect_tooltip = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 1000
					producer = FROM
				}
				add_equipment_to_stockpile = {
					type = support_equipment
					amount = 200
					producer = FROM
				}
			}
		}		
	}
}

 ######   #######  ##     ##          ######   ######## ########     ######## ########     ###    ########  ########       ###     ######   ########  ######## ######## ##     ## ######## ##    ## ######## 
##    ## ##     ## ##     ##         ##    ##  ##       ##     ##       ##    ##     ##   ## ##   ##     ## ##            ## ##   ##    ##  ##     ## ##       ##       ###   ### ##       ###   ##    ##    
##       ##     ## ##     ##         ##        ##       ##     ##       ##    ##     ##  ##   ##  ##     ## ##           ##   ##  ##        ##     ## ##       ##       #### #### ##       ####  ##    ##    
 ######  ##     ## ##     ## ####### ##   #### ######   ########        ##    ########  ##     ## ##     ## ######      ##     ## ##   #### ########  ######   ######   ## ### ## ######   ## ## ##    ##    
      ## ##     ##  ##   ##          ##    ##  ##       ##   ##         ##    ##   ##   ######### ##     ## ##          ######### ##    ##  ##   ##   ##       ##       ##     ## ##       ##  ####    ##    
##    ## ##     ##   ## ##           ##    ##  ##       ##    ##        ##    ##    ##  ##     ## ##     ## ##          ##     ## ##    ##  ##    ##  ##       ##       ##     ## ##       ##   ###    ##    
 ######   #######     ###             ######   ######## ##     ##       ##    ##     ## ##     ## ########  ########    ##     ##  ######   ##     ## ######## ######## ##     ## ######## ##    ##    ##    


# Soviet-German Trade Agreement - Event for GER
country_event = {
	id = NSB_soviet_soviet_german_trade_agreement.1
	title = NSB_soviet_soviet_german_trade_agreement.1.t
	desc = NSB_soviet_soviet_german_trade_agreement.1.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes
			
	option = { # Accept -> This will also make GER more likely to take Molotov-Ribbentrop pact and less to take Anti-Soviet Pact
		name = NSB_soviet_soviet_german_trade_agreement.1.a

		ai_chance = {
			base = 5
			modifier = {
				factor = 10
				has_war = yes
			}
			modifier = {
				factor = 10
				has_war_with = ENG
			}
			modifier = {
				factor = 10
				has_completed_focus = GER_mol_rib_pact
			}
		}

		add_timed_idea = { idea = SOV_soviet_german_trade_agreement days = 545 } #Technically 1 year but really 18 months for Soviet payment 
		set_variable = { SOV_capital_for_soviet_imports = ROOT.capital } #Store capital where the dynamic modifier is set so that it can be removed easily later
		capital_scope = {
			add_dynamic_modifier = { modifier = SOV_soviet_imports }
		}

		#Effects to Soviets
		effect_tooltip = {
			FROM = {
				if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					if = {
						limit = {
							NOT = { has_tech = basic_ship_hull_cruiser }
						}
						set_technology = { basic_ship_hull_cruiser = 1 }
					}
					if = {
						limit = {
							NOT = { has_tech = basic_cruiser_armor_scheme }
						}
						set_technology = { basic_cruiser_armor_scheme = 1 }
					}
					if = {
						limit = {
							has_tech = basic_medium_battery
						}
						create_equipment_variant = {
							name = "Hipper Class"
							type = ship_hull_cruiser_2
							name_group = SOV_CA_HISTORICAL
							parent_version = 0
							modules = {
								fixed_ship_battery_slot = ship_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_1
								fixed_ship_secondaries_slot = empty
								fixed_ship_armor_slot = ship_armor_cruiser_2
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_medium_battery_2
							}
						}
					}
					else = {
						create_equipment_variant = {
							name = "Hipper Class"
							type = ship_hull_cruiser_2
							name_group = SOV_CA_HISTORICAL
							parent_version = 0
							modules = {
								fixed_ship_battery_slot = ship_medium_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_1
								fixed_ship_secondaries_slot = empty
								fixed_ship_armor_slot = ship_armor_cruiser_2
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_medium_battery_1
							}
						}
					}
					
					# CA: Ltzow -> Petropavlovsk
					add_equipment_production = {
						equipment = {
							type = ship_hull_cruiser_2
							creator = "SOV"
							version_name = "Hipper Class"
						}
						name = "Petropavlovsk"
						requested_factories = 1
						progress = 0.5
						amount = 1
					}

					add_tech_bonus = {
						name = NSB_soviet_soviet_german_trade_agreement.1.t
						bonus = 0.5
						uses = 2
						category = ship_modules_tech
						category = bb_tech
						category = dd_tech
					}
				}
				else = { #No MTG
					if = {
						limit = {
							NOT = { has_tech = basic_heavy_cruiser }
						}
						set_technology = { basic_heavy_cruiser = 1 }
					}
					create_equipment_variant = {
						name = "Hipper Class"
						type = heavy_cruiser_2
						parent_version = 0
						upgrades = {
							ship_reliability_upgrade = 1
							ship_engine_upgrade = 1
							ship_armor_upgrade = 2
							ship_gun_upgrade = 2
						}
					}

					add_equipment_production = {
						equipment = {
							type = heavy_cruiser_2
							creator = "SOV"
						}
						requested_factories = 1
						progress = 0.5
						amount = 1
					}

					add_tech_bonus = {
						name = NSB_soviet_soviet_german_trade_agreement.1.t
						bonus = 0.5
						uses = 2
						category = ca_tech
						category = bb_tech
						category = dd_tech
					}
				}

				add_tech_bonus = {
					name = NSB_soviet_soviet_german_trade_agreement.1.t
					bonus = 0.5
					uses = 2
					category = air_equipment
				}
			}
		}

		add_opinion_modifier = {
			target = FROM
			modifier = SOV_strengthened_relations_with_us
		}
		FROM = {
			add_opinion_modifier = {
				target = ROOT
				modifier = SOV_strengthened_relations_with_us
			}
		}
		hidden_effect = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_strengthened_relations_with_us_trade
			}
			FROM = {
				add_opinion_modifier = {
					target = ROOT
					modifier = SOV_strengthened_relations_with_us_trade
				}
			}
		}
		FROM = { country_event = { id = NSB_soviet_soviet_german_trade_agreement.2 hours = 1 } }
	}

	option = { # Refuse
		name = NSB_soviet_soviet_german_trade_agreement.1.b

		ai_chance = {
			base = 1
		}

		FROM = {
			country_event = { id = NSB_soviet_soviet_german_trade_agreement.3 hours = 1 }
			add_opinion_modifier = {
				target = ROOT
				modifier = SOV_rejected_our_demands
			}
		}
	}
}

# Soviet-German Trade Agreement - GER Accepts - Event for SOV
country_event = {
	id = NSB_soviet_soviet_german_trade_agreement.2
	title = NSB_soviet_soviet_german_trade_agreement.2.t
	desc = NSB_soviet_soviet_german_trade_agreement.2.desc
	picture = GFX_report_event_molotov_ribentrop_handshake

	is_triggered_only = yes
			
	option = { # Good
		name = NSB_soviet_soviet_german_trade_agreement.2.a

		if = {
			limit = {
				has_dlc = "Man the Guns"
			}
			if = {
				limit = {
					NOT = { has_tech = basic_ship_hull_cruiser }
				}
				set_technology = { basic_ship_hull_cruiser = 1 }
			}
			if = {
				limit = {
					NOT = { has_tech = basic_cruiser_armor_scheme }
				}
				set_technology = { basic_cruiser_armor_scheme = 1 }
			}
			if = {
				limit = {
					has_tech = basic_medium_battery
				}
				create_equipment_variant = {
					name = "Hipper Class"
					type = ship_hull_cruiser_2
					name_group = SOV_CA_HISTORICAL
					parent_version = 0
					modules = {
						fixed_ship_battery_slot = ship_medium_battery_2
						fixed_ship_anti_air_slot = ship_anti_air_1
						fixed_ship_fire_control_system_slot = ship_fire_control_system_0
						fixed_ship_radar_slot = empty
						fixed_ship_engine_slot = cruiser_ship_engine_1
						fixed_ship_secondaries_slot = empty
						fixed_ship_armor_slot = ship_armor_cruiser_2
						front_1_custom_slot = ship_anti_air_1
						mid_1_custom_slot = ship_torpedo_1
						mid_2_custom_slot = ship_airplane_launcher_1
						rear_1_custom_slot = ship_medium_battery_2
					}
				}
			}
			else = {
				create_equipment_variant = {
					name = "Hipper Class"
					type = ship_hull_cruiser_2
					name_group = SOV_CA_HISTORICAL
					parent_version = 0
					modules = {
						fixed_ship_battery_slot = ship_medium_battery_1
						fixed_ship_anti_air_slot = ship_anti_air_1
						fixed_ship_fire_control_system_slot = ship_fire_control_system_0
						fixed_ship_radar_slot = empty
						fixed_ship_engine_slot = cruiser_ship_engine_1
						fixed_ship_secondaries_slot = empty
						fixed_ship_armor_slot = ship_armor_cruiser_2
						front_1_custom_slot = ship_anti_air_1
						mid_1_custom_slot = ship_torpedo_1
						mid_2_custom_slot = ship_airplane_launcher_1
						rear_1_custom_slot = ship_medium_battery_1
					}
				}
			}
			
			# CA: Ltzow -> Petropavlovsk
			add_equipment_production = {
				equipment = {
					type = ship_hull_cruiser_2
					creator = "SOV"
					version_name = "Hipper Class"
				}
				name = "Petropavlovsk"
				requested_factories = 1
				progress = 0.5
				amount = 1
			}

			add_tech_bonus = {
				name = NSB_soviet_soviet_german_trade_agreement.1.t
				bonus = 0.5
				uses = 2
				category = ship_modules_tech
				category = bb_tech
				category = dd_tech
			}			
		}
		else = { #No MTG
			if = {
				limit = {
					NOT = { has_tech = basic_heavy_cruiser }
				}
				set_technology = { basic_heavy_cruiser = 1 }
			}
			create_equipment_variant = {
				name = "Hipper Class"
				type = heavy_cruiser_2
				parent_version = 0
				upgrades = {
					ship_reliability_upgrade = 1
					ship_engine_upgrade = 1
					ship_armor_upgrade = 2
					ship_gun_upgrade = 2
				}
			}

			add_equipment_production = {
				equipment = {
					type = heavy_cruiser_2
					creator = "SOV"
				}
				requested_factories = 1
				progress = 0.5
				amount = 1
			}

			add_tech_bonus = {
				name = NSB_soviet_soviet_german_trade_agreement.1.t
				bonus = 0.5
				uses = 2
				category = ca_tech
				category = bb_tech
				category = dd_tech
			}
		}

		add_tech_bonus = {
			name = NSB_soviet_soviet_german_trade_agreement.1.t
			bonus = 0.5
			uses = 2
			category = air_equipment
		}

		#Effects to Germans
		effect_tooltip = {
			FROM = {
				add_timed_idea = { idea = SOV_soviet_german_trade_agreement days = 545 } #Technically 1 year but really 18 months for Soviet payment 
				capital_scope = {
					add_dynamic_modifier = { modifier = SOV_soviet_imports }
				}
			}

			add_opinion_modifier = {
				target = FROM
				modifier = SOV_strengthened_relations_with_us
			}
			FROM = {
				add_opinion_modifier = {
					target = ROOT
					modifier = SOV_strengthened_relations_with_us
				}
			}
		}
		hidden_effect = { news_event = { id = nsb_news.103 days = 1 } }
	}
}

# Soviet-German Trade Agreement - GER Refuses - Event for SOV
country_event = {
	id = NSB_soviet_soviet_german_trade_agreement.3
	title = NSB_soviet_soviet_german_trade_agreement.3.t
	desc = NSB_soviet_soviet_german_trade_agreement.3.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes
			
	option = { # Damn
		name = NSB_soviet_soviet_german_trade_agreement.3.a

		effect_tooltip = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_rejected_our_demands
			}
		}
	}
}


 ######   #######  ##       ##       ########  ######  ######## #### ##     ## ########     ######  ########  ######  ##     ## ########  #### ######## ##    ## 
##    ## ##     ## ##       ##       ##       ##    ##    ##     ##  ##     ## ##          ##    ## ##       ##    ## ##     ## ##     ##  ##     ##     ##  ##  
##       ##     ## ##       ##       ##       ##          ##     ##  ##     ## ##          ##       ##       ##       ##     ## ##     ##  ##     ##      ####   
##       ##     ## ##       ##       ######   ##          ##     ##  ##     ## ######       ######  ######   ##       ##     ## ########   ##     ##       ##    
##       ##     ## ##       ##       ##       ##          ##     ##   ##   ##  ##                ## ##       ##       ##     ## ##   ##    ##     ##       ##    
##    ## ##     ## ##       ##       ##       ##    ##    ##     ##    ## ##   ##          ##    ## ##       ##    ## ##     ## ##    ##   ##     ##       ##    
 ######   #######  ######## ######## ########  ######     ##    ####    ###    ########     ######  ########  ######   #######  ##     ## ####    ##       ##    


# Policies of Collective Security - SOV offers Mutual Assitance - Event for FRA
country_event = {
	id = NSB_soviet_policies_of_collective_security.1
	title = NSB_soviet_policies_of_collective_security.1.t
	desc = NSB_soviet_policies_of_collective_security.1.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes
			
	option = { # Accept
		name = NSB_soviet_policies_of_collective_security.1.a

		ai_chance = {
			base = 10
			modifier = {
				factor = 2
				OR = {
					has_government = democratic
					has_government = communism
				}
			}
			modifier = {
				factor = 2
				has_opinion = {
					target = FROM
					value > 50
				}
			}
			modifier = {
				factor = 1.5
				has_opinion = {
					target = FROM
					value > 90
				}
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 1.5
				SOV = { has_idea = SOV_maksim_litvinov }
			}
		}

		effect_tooltip = {
			SOV_clear_hostile_diplomacy_in_both_countries = yes #Clears wargoals and claims

			#SOV -> FRA
			FROM = {		
				diplomatic_relation = {
					country = ROOT
					relation = non_aggression_pact
					active = yes
				}
				give_guarantee = ROOT
				add_opinion_modifier = { 
					target = ROOT
					modifier = SOV_policies_of_collective_security_opinion
				}
			}

			#FRA -> SOV
			diplomatic_relation = {
				country = FROM
				relation = non_aggression_pact
				active = yes
			}
			give_guarantee = FROM
			add_opinion_modifier = { 
				target = FROM
				modifier = SOV_policies_of_collective_security_opinion
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.2 hours = 8 random_hours = 4 } }
	}

	option = { # Conditions
		name = NSB_soviet_policies_of_collective_security.1.b

		ai_chance = {
			base = 10
			modifier = {
				factor = 4
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 1.5
				has_government = democratic
			}
			modifier = {
				factor = 1.5
				is_in_faction_with = ENG
				ENG = { has_government = democratic }
			}
			modifier = {
				factor = 4
				has_guaranteed = POL 
			}
		}

		trigger = { #Only European countries care about Poland
			FROM = {
				var:SOV_collective_security_target = {
					capital_scope = { is_on_continent = europe }
				}
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.4 hours = 8 random_hours = 4 } }

		effect_tooltip = {
			custom_effect_tooltip = NSB_soviet_policies_of_collective_security_agreed_effects_tt
			SOV_clear_hostile_diplomacy_in_both_countries = yes #Clears wargoals and claims

			#SOV -> FRA
			FROM = {		
				diplomatic_relation = {
					country = ROOT
					relation = non_aggression_pact
					active = yes
				}
				give_guarantee = ROOT
				add_opinion_modifier = { 
					target = ROOT
					modifier = SOV_policies_of_collective_security_opinion
				}
			}

			#FRA -> SOV
			diplomatic_relation = {
				country = FROM
				relation = non_aggression_pact
				active = yes
			}
			give_guarantee = FROM
			add_opinion_modifier = { 
				target = FROM
				modifier = SOV_policies_of_collective_security_opinion
			}

			custom_effect_tooltip = NSB_soviet_policies_of_collective_security_condition_effects_tt
		}
	}

	option = { # Nope
		name = NSB_soviet_policies_of_collective_security.1.c

		effect_tooltip = {
			FROM = {
				add_opinion_modifier = { 
					target = ROOT
					modifier = SOV_rejected_defensive_pact
				}
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.3 hours = 8 random_hours = 4 } }
	}
}

# Policies of Collective Security - FRA accepts - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.2
	title = NSB_soviet_policies_of_collective_security.2.t
	desc = NSB_soviet_policies_of_collective_security.2.desc
	picture = GFX_report_event_worried_french

	is_triggered_only = yes
			
	option = { # Good
		name = NSB_soviet_policies_of_collective_security.2.a

		SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes

		FROM = { save_global_event_target_as = SOV_collective_security_pact_integrant }
		hidden_effect = { news_event = { id = nsb_news.102 days = 1 } } #Poland not Included
	}
}

# Policies of Collective Security - FRA refuses - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.3
	title = NSB_soviet_policies_of_collective_security.3.t
	desc = NSB_soviet_policies_of_collective_security.3.desc
	picture = GFX_report_event_worried_french

	is_triggered_only = yes
			
	option = { # OK
		name = NSB_soviet_policies_of_collective_security.3.a

		add_opinion_modifier = { 
			target = FROM
			modifier = SOV_rejected_defensive_pact
		}
	}
}

# Policies of Collective Security - FRA wants to include Poland - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.4
	title = NSB_soviet_policies_of_collective_security.4.t
	desc = NSB_soviet_policies_of_collective_security.4.desc
	picture = GFX_report_event_worried_french

	is_triggered_only = yes
			
	option = { # Consent
		name = NSB_soviet_policies_of_collective_security.4.a

		ai_chance = {
			base = 10
			modifier = {
				factor = 5
				has_opinion = {
					target = FROM
					value > 25
				}
			}
			modifier = {
				factor = 5
				has_opinion = {
					target = POL
					value > 25
				}
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 1.5
				SOV = { has_idea = SOV_maksim_litvinov }
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.6 hours = 8 random_hours = 4 } }

		custom_effect_tooltip = NSB_soviet_policies_of_collective_security_tt
	}

	option = { # No way Poland is being included here
		name = NSB_soviet_policies_of_collective_security.4.b

		ai_chance = {
			base = 10
		}

		custom_effect_tooltip = NSB_soviet_policies_of_collective_security_refusing_poland_inclusion_tt

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.5 hours = 8 random_hours = 4 } }

		custom_effect_tooltip = NSB_soviet_policies_of_collective_security_agreed_effects_tt
		effect_tooltip = {
			SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes
		}
	}
}

# Policies of Collective Security - SOV rejects Poland's inclusion - Event for FRA
country_event = {
	id = NSB_soviet_policies_of_collective_security.5
	title = NSB_soviet_policies_of_collective_security.5.t
	desc = NSB_soviet_policies_of_collective_security.5.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes
			
	option = { # Avanti without Poland
		name = NSB_soviet_policies_of_collective_security.5.a

		ai_chance = {
			base = 10
			modifier = {
				factor = 2
				has_government = communism
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 1.25
				SOV = { has_idea = SOV_maksim_litvinov }
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.9 hours = 8 random_hours = 4 } }

		effect_tooltip = {
			SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes
		}
	}

	option = { # Not interested, then
		name = NSB_soviet_policies_of_collective_security.5.b

		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 1.5
				has_government = democratic
			}
			modifier = {
				factor = 2
				has_guaranteed = POL 
			}
			modifier = {
				factor = 0
				OR = {
					NOT = { country_exists = POL }
					POL = { has_capitulated = yes }
				}
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.8 hours = 8 random_hours = 4 } }
	}
}

# Policies of Collective Security - SOV accepts Poland's inclusion - Event for FRA
country_event = {
	id = NSB_soviet_policies_of_collective_security.6
	title = NSB_soviet_policies_of_collective_security.6.t
	desc = NSB_soviet_policies_of_collective_security.6.desc
	picture = GFX_report_event_SOV_litvinov_beck

	is_triggered_only = yes
			
	option = { # Good, let's ask POL
		name = NSB_soviet_policies_of_collective_security.6.a

		if = {
			limit = {
				country_exists = POL
			}
			POL = { country_event = { id = NSB_soviet_policies_of_collective_security.7 hours = 8 random_hours = 4 } } #Don't waste time, send it right away, Poland tends to die

			effect_tooltip = {
				SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes
			}
			custom_effect_tooltip = NSB_soviet_policies_of_collective_security_tt
		}
		else = { #Fallback in case Poland gets wiped out during this political jobbery
			FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.2 hours = 8 random_hours = 4 } }

			effect_tooltip = {
				SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes
			}
		}
	}
}

# Policies of Collective Security - Wanna join Soviet-French <-(potentially) Mutual Assitance pact? - Event for POL
country_event = {
	id = NSB_soviet_policies_of_collective_security.7
	title = NSB_soviet_policies_of_collective_security.7.t
	desc = NSB_soviet_policies_of_collective_security.7.desc
	picture = GFX_report_event_SOV_litvinov_beck

	is_triggered_only = yes
			
	option = { # Accept
		name = NSB_soviet_policies_of_collective_security.7.a

		ai_chance = {
			base = 10
			modifier = {
				factor = 2
				OR = {
					has_government = democratic
					has_government = communism
				}
			}
			modifier = {
				factor = 2
				is_in_faction = no
			}
			modifier = { #Appropriate PC for Foreign Affairs
				factor = 1.2
				SOV = { has_idea = SOV_maksim_litvinov }
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.12 hours = 8 random_hours = 4 } } #Answer to FRA (potentially) who will in turn asnswer to SOV, so FROM is available for effects that can't use variables

		custom_effect_tooltip = NSB_soviet_policies_of_collective_security_poland_included_effects_from_tt
	}

	option = { # Not interested
		name = NSB_soviet_policies_of_collective_security.7.b

		ai_chance = {
			base = 10
			modifier = {
				factor = 4
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 4
				any_country = {
					is_major = yes
					has_guaranteed = POL
				}
			}
			modifier = {
				factor = 2
				has_government = fascism
			}
		}

		FROM = { country_event = { id = NSB_soviet_policies_of_collective_security.10 hours = 10 random_hours = 4 } }
	}
}

# Policies of Collective Security - FRA refuses the pact without Poland - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.8
	title = NSB_soviet_policies_of_collective_security.8.t
	desc = NSB_soviet_policies_of_collective_security.8.desc
	picture = GFX_report_event_generic_sign_treaty2

	is_triggered_only = yes
			
	option = { # Who needs them anyway?
		name = NSB_soviet_policies_of_collective_security.8.a

	}
}

# Policies of Collective Security - FRA agrees to the pact not including Poland - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.9
	title = NSB_soviet_policies_of_collective_security.9.t
	desc = NSB_soviet_policies_of_collective_security.9.desc
	picture = GFX_report_event_generic_sign_treaty1

	is_triggered_only = yes
			
	option = { # Shame on them
		name = NSB_soviet_policies_of_collective_security.9.a

		SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes

		FROM = { save_global_event_target_as = SOV_collective_security_pact_integrant }
		hidden_effect = { news_event = { id = nsb_news.102 days = 1 } } #Poland not Included
	}
}

# Policies of Collective Security - Poland does not want to be involved in any of this - Event for FRA
country_event = {
	id = NSB_soviet_policies_of_collective_security.10
	title = NSB_soviet_policies_of_collective_security.10.t
	desc = NSB_soviet_policies_of_collective_security.10.desc
	picture = GFX_report_event_polish_army

	is_triggered_only = yes
			
	option = { # Who needs them anyway?
		name = NSB_soviet_policies_of_collective_security.10.a

		SOV = { country_event = { id = NSB_soviet_policies_of_collective_security.11 hours = 10 random_hours = 4 } }

		effect_tooltip = {
			SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes
		}
	}
}

# Policies of Collective Security - Poland refused to join our pact, let's just sign it ourselves - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.11
	title = NSB_soviet_policies_of_collective_security.11.t
	desc = NSB_soviet_policies_of_collective_security.11.desc
	picture = GFX_report_event_generic_sign_treaty1

	is_triggered_only = yes
			
	option = { # Who needs them anyway?
		name = NSB_soviet_policies_of_collective_security.11.a

		SOV_apply_collective_ageement_on_mutual_assistance_effects_basic = yes

		FROM = { save_global_event_target_as = SOV_collective_security_pact_integrant }
		hidden_effect = { news_event = { id = nsb_news.102 days = 1 } } #Poland not Included
	}
}

# Policies of Collective Security - Poland joins our pact, hurray! - Event for FRA
country_event = {
	id = NSB_soviet_policies_of_collective_security.12
	title = NSB_soviet_policies_of_collective_security.12.t
	desc = NSB_soviet_policies_of_collective_security.12.desc
	picture = GFX_report_event_SOV_litvinov_beck

	is_triggered_only = yes
			
	option = { # COOL
		name = NSB_soviet_policies_of_collective_security.12.a

		SOV = { country_event = { id = NSB_soviet_policies_of_collective_security.13 hours = 10 random_hours = 4 } }

		custom_effect_tooltip = NSB_soviet_policies_of_collective_security_poland_included_effects_from_tt
	}
}

# Policies of Collective Security - Poland joins our pact, viva! - Event for SOV
country_event = {
	id = NSB_soviet_policies_of_collective_security.13
	title = NSB_soviet_policies_of_collective_security.12.t
	desc = NSB_soviet_policies_of_collective_security.13.desc
	picture = GFX_report_event_SOV_litvinov_beck

	is_triggered_only = yes
			
	option = {
		name = NSB_soviet_policies_of_collective_security.13.a

		custom_effect_tooltip = NSB_soviet_policies_of_collective_security_poland_included_effects_from_tt

		hidden_effect = {
			SOV_apply_collective_ageement_on_mutual_assistance_effects_poland_included = yes
		}

		FROM = { save_global_event_target_as = SOV_collective_security_pact_integrant }
		set_global_flag = SOV_collective_security_pact_poland_inlcuded_flag
		hidden_effect = { news_event = { id = nsb_news.102 days = 1 } } #Poland Included
	}
}



# SOV builds a National Academy of Sciences in our country
country_event = {
	id = NSB_soviet_academy_of_sciences.1
	title = NSB_soviet_academy_of_sciences.1.t
	desc = NSB_soviet_academy_of_sciences.1.desc
	picture = GFX_report_event_SOV_national_academy_of_sciences

	is_triggered_only = yes
			
	option = { # Accept
		name = NSB_soviet_academy_of_sciences.1.a

		add_ideas = SOV_national_academy_of_sciences_puppet
	}
}


# SOV infiltrates an atomic program - Success - Event for SOV (Only non-LaR)
country_event = {
	id = NSB_soviet_atomic_bomb_project.1
	title = NSB_soviet_atomic_bomb_project.1.t
	desc = NSB_soviet_atomic_bomb_project.1.desc
	picture = GFX_report_event_SOV_demands

	is_triggered_only = yes
			
	option = { # Good
		name = NSB_soviet_atomic_bomb_project.1.a

		if = {
			limit = {
				NOT = { has_tech = nukes }
			}
			add_tech_bonus = {
				name = SOV_soviet_atomic_bomb_project
				bonus = 1
				uses = 1
				category = nuclear
			}
		}
		else = {
			add_timed_idea = {
				idea = SOV_stolen_vital_nuclear_information
				days = 180
			}
		}
	}
}

# SOV fails to infiltrate an atomic program - Failure - Event for SOV
country_event = {
	id = NSB_soviet_atomic_bomb_project.2
	title = NSB_soviet_atomic_bomb_project.2.t
	desc = NSB_soviet_atomic_bomb_project.2.desc
	picture = GFX_report_event_SOV_atomic_program_caught

	is_triggered_only = yes
			
	option = { # Bad, but okay
		name = NSB_soviet_atomic_bomb_project.2.a

		add_political_power = -50

		effect_tooltip = {
			var:SOV_aggrieved_country_atomic_spies = {
				if = {
					limit = {
						original_tag = USA
					}
					add_opinion_modifier = {
						target = ROOT
						modifier = SOV_attempted_to_infiltrate_manhattan_project
					}
				}
				else = {
					add_opinion_modifier = {
						target = ROOT
						modifier = SOV_attempted_to_infiltrate_our_atomic_program
					}
				}
			}
		}
	}
}

# SOV fails to infiltrate an atomic program - Failure - Event for target country
country_event = {
	id = NSB_soviet_atomic_bomb_project.3
	title = NSB_soviet_atomic_bomb_project.3.t
	desc = NSB_soviet_atomic_bomb_project.3.desc
	picture = GFX_report_event_SOV_atomic_program_caught

	is_triggered_only = yes
			
	option = { # Good
		name = NSB_soviet_atomic_bomb_project.3.a

		add_political_power = 50

		if = {
			limit = {
				original_tag = USA
			}
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_attempted_to_infiltrate_manhattan_project
			}
		}
		else = {
			add_opinion_modifier = {
				target = FROM
				modifier = SOV_attempted_to_infiltrate_our_atomic_program
			}
		}

		effect_tooltip = {
			FROM = {
				add_political_power = -50
			}
		}
	}
}


######################
### FIVE YEAR PLAN ###
######################

### THIRD FIVE YEAR PLAN CANCELED ###
country_event = {
	id = NSB_soviet_five_year_plan.01
	title = NSB_soviet_five_year_plan.01.t
	desc = NSB_soviet_five_year_plan.01.desc
	picture = GFX_report_event_stalin_01
	
	is_triggered_only = yes

	fire_only_once = yes

	option = { #VAYA POR DIOS
		name = NSB_soviet_five_year_plan.01.a
		
		custom_effect_tooltip = NSB_soviet_five_year_plan_tt
	}
}



######################
######## MISC ########
######################

### Kuznetsov becomes an Operative -> Fired when SOV loses control over a Ukrainian state 
country_event = {
	id = NSB_soviet_great_patriotic_war.01
	title = NSB_soviet_great_patriotic_war.01.t
	desc = NSB_soviet_great_patriotic_war.01.desc
	picture = GFX_report_event_SOV_tank_column
	
	is_triggered_only = yes

	fire_only_once = yes

	option = { #WELCOME TO THE NKVD
		name = NSB_soviet_great_patriotic_war.01.a

		create_operative_leader = {
			name = "Nikolay Ivanovich Kuznetsov"
			GFX = GFX_Portrait_nikolay_kuznetsov
			traits = { operative_commando operative_infiltrator }
			bypass_recruitment = no
			available_to_spy_master = yes
			nationalities = { SOV GER  }
		}
	}
}


#########################
### SPANISH CIVIL WAR ###
#########################

#REPUBLICAN SPAIN / POUM LOSES THE SCW -> LSTER / EL CAMPESINO / ROVIRA JOINS SOV -> Event for SOV
unit_leader_event = {
	id = NSB_soviet_spanish_civil_war.1
	title = NSB_soviet_spanish_civil_war.1.t
	desc = NSB_soviet_spanish_civil_war.1.desc
	
	is_triggered_only = yes
	hidden = no

	option = {
		name = NSB_soviet_spanish_civil_war.1.a
		effect_tooltip = {
			var:SOV.SOV_spanish_general = { set_nationality = SOV }
		}
	}
}

# POUM - SOV has organized International Marxist Brigades -> Event for SPC
country_event = {
	id = NSB_soviet_spanish_civil_war.2
	title = NSB_soviet_spanish_civil_war.2.t
	desc = NSB_soviet_spanish_civil_war.2.desc
	picture = GFX_report_event_spr_poum_militia
	
	is_triggered_only = yes

	option = {
		name = NSB_soviet_spanish_civil_war.2.a
		
		if = {
			limit = {
				NOT = { has_template = "International Marxist Brigades" }
			}
			division_template = {
				name = "International Marxist Brigades"
				is_locked = yes
				priority = 1
				template_counter = 14
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
				}
			}
		}
		capital_scope = {
			create_unit = { 
				division = "name = \"International Marxist Brigade\" division_template = \"International Marxist Brigades\" start_experience_factor = 0.1 start_equipment_factor = 1.0" owner = ROOT count = 6
			}
		}
	}
}

# POUM - SOV has sent special commandos -> Event for SPC
country_event = {
	id = NSB_soviet_spanish_civil_war.3
	title = NSB_soviet_spanish_civil_war.3.t
	desc = NSB_soviet_spanish_civil_war.3.desc
	picture = GFX_report_event_spr_the_maquis
	
	is_triggered_only = yes

	option = {
		name = NSB_soviet_spanish_civil_war.3.a
		
		add_timed_idea = {
			idea = SOV_soviet_commandos_poum
			days = 180
		}

		if = {
			limit = {
				NOT = { has_template = "Soviet Special Brigades" }
			}
			division_template = {
				name = "Soviet Special Brigades"
				is_locked = yes
				priority = 1
				template_counter = 02
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
					infantry = { x = 1 y = 2 }
				}
				support = {
					engineer = { x = 0 y = 0 }
					recon = { x = 0 y = 1 }
					artillery = { x = 0 y = 2 }
					anti_tank = { x = 0 y = 3 }
				}
			}
		}
		capital_scope = {
			create_unit = { 
				division = "name = \"Soviet Special Brigade\" division_template = \"Soviet Special Brigades\" start_experience_factor = 0.7 start_equipment_factor = 1.0" owner = ROOT count = 2
			}
		}
	}
}

# POUM - SOV has organized popular speeches in the country -> Event for SPC
country_event = {
	id = NSB_soviet_spanish_civil_war.4
	title = NSB_soviet_spanish_civil_war.4.t
	desc = NSB_soviet_spanish_civil_war.4.desc
	picture = GFX_report_event_spr_anarchists
	
	is_triggered_only = yes

	option = {
		name = NSB_soviet_spanish_civil_war.4.a
		
		add_timed_idea = {
			idea = SOV_popular_speeches_poum
			days = 180
		}

		if = {
			limit = {
				NOT = { has_template = "International Marxist Brigades" }
			}
			division_template = {
				name = "International Marxist Brigades"
				is_locked = yes
				priority = 1
				template_counter = 14
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
				}
			}
		}
		capital_scope = {
			create_unit = { 
				division = "name = \"International Marxist Brigade\" division_template = \"International Marxist Brigades\" start_experience_factor = 0.1 start_equipment_factor = 1.0" owner = ROOT count = 2
			}
		}
	}
}

# POUM - SOV has infiltrate the Stalinist command in Spain -> Event for SPC
country_event = {
	id = NSB_soviet_spanish_civil_war.5
	title = NSB_soviet_spanish_civil_war.5.t
	desc = NSB_soviet_spanish_civil_war.5.desc
	picture = GFX_report_event_spr_republican_soldiers
	
	is_triggered_only = yes

	option = {
		name = NSB_soviet_spanish_civil_war.5.a
		
		add_timed_idea = {
			idea = SOV_agents_in_the_stalinist_command_poum
			days = 365
		}
	}
}

# POUM won CW -> Troops will aid Right Oppo in the Soviet CW -> Event for SOV
country_event = {
	id = NSB_soviet_spanish_civil_war.6
	title = NSB_soviet_spanish_civil_war.6.t
	desc = {
		text = NSB_soviet_spanish_civil_war.6.desc_1
		trigger = {
			NOT = { has_global_flag = SOV_soviet_civil_war }
		}
	}
	desc = {
		text = NSB_soviet_spanish_civil_war.6.desc_2
		trigger = {
			has_global_flag = SOV_soviet_civil_war
		}
	}
	picture = GFX_report_event_spr_anarchists2

	is_triggered_only = yes

	trigger = {
		OR = { #Do not trigger if Soviet civil war has finished or was bypassed
			has_global_flag = SOV_soviet_civil_war
		}
	}

	immediate = {
		set_country_flag = SOV_poum_brigades_ready_to_help_flag #Will be checked when the Soviet CW happens, and effects will be run in the CW setup effect
	}

	# Nice, comrades! -> Soviet Civil War has not happen
	option = {
		name = NSB_soviet_spanish_civil_war.6.a

		trigger = {
			NOT = { has_global_flag = SOV_soviet_civil_war }
		}
		
		custom_effect_tooltip = SOV_poum_aid_in_case_of_civil_War_tt
	}

	#Let's kick some asses! -> Soviet Civil War is ongoing
	option = {
		name = NSB_soviet_spanish_civil_war.6.a

		trigger = {
			has_global_flag = SOV_soviet_civil_war
		}

		SOV_poum_brigades_to_soviet_civil_war_effect = yes
	}
}


#######################
### PLANNED ECONOMY ###
#######################

# SOV planned economy - Event for puppets
country_event = {
	id = NSB_soviet_planned_economy.1
	title = NSB_soviet_planned_economy.1.t
	desc = NSB_soviet_planned_economy.1.desc
	picture = GFX_report_event_SOV_national_academy_of_sciences

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			FROM = {
				if = {
					limit = {
						check_variable = { SOV_planned_economy_industrial_capacity_factory_initial < 0.1 }
					}
					add_to_variable = { SOV_planned_economy_industrial_capacity_factory_initial = 0.01 }
				}
				if = {
					limit = {
						check_variable = { SOV_planned_economy_production_lack_of_resource_penalty_factor_initial > -0.1 }
					}
					add_to_variable = { SOV_planned_economy_production_lack_of_resource_penalty_factor_initial = -0.01 }
				}
			}
			add_tech_bonus = {
				name = NSB_soviet_planned_economy.1.t
				bonus = 1.0
				uses = 2
				category = industry
			}

			add_ideas = new_economic_policy
		}
	}
			
	option = { # Good
		name = NSB_soviet_planned_economy.1.a

		effect_tooltip = {
			add_tech_bonus = {
				name = NSB_soviet_planned_economy.1.t
				bonus = 1.0
				uses = 2
				category = industry
			}

			add_ideas = new_economic_policy
		}
	}
}